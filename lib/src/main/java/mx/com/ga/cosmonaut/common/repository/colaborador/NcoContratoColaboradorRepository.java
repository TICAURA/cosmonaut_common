package mx.com.ga.cosmonaut.common.repository.colaborador;

import io.micronaut.data.annotation.Join;
import io.micronaut.data.annotation.Query;
import io.micronaut.data.jdbc.annotation.JdbcRepository;
import io.micronaut.data.model.query.builder.sql.Dialect;
import io.micronaut.data.repository.CrudRepository;
import mx.com.ga.cosmonaut.common.entity.catalogo.negocio.CatTipoBaja;
import mx.com.ga.cosmonaut.common.entity.cliente.*;
import mx.com.ga.cosmonaut.common.entity.colaborador.NcoContratoColaborador;
import mx.com.ga.cosmonaut.common.entity.colaborador.NcoPersona;

import java.math.BigDecimal;
import java.util.Date;
import java.util.List;
import java.util.Optional;

@JdbcRepository(dialect = Dialect.POSTGRES)
public interface NcoContratoColaboradorRepository extends CrudRepository<NcoContratoColaborador, Date> {

    @Query(value = "select COUNT(persona_id) from nco_contrato_colaborador ncc where ncc.centroc_cliente_id = :idCliente "
            + "and ncc.area_id = :idArea and ncc.puesto_id = :idPuesto",nativeQuery=true)
    Integer findAreaPuestoXColaborador(Integer idCliente, Integer idArea, Integer idPuesto);

    @Query(value = "select COUNT(persona_id) from nco_contrato_colaborador ncc where ncc.centroc_cliente_id = :idCliente "
            + "and ncc.area_id = :idArea",nativeQuery=true)
    Integer findAreaXColaborador(Integer idCliente, Integer idArea);

    @Query(value = "select COUNT(persona_id) from nco_contrato_colaborador ncc where ncc.centroc_cliente_id = :idCliente "
            + "and ncc.politica_id = :idPolitica",nativeQuery=true)
    Integer findAreaPoliticaXColaborador(Integer idCliente, Integer idPolitica);

        @Query(value = "select COUNT(de_jornada_id) from nco_contrato_colaborador ncc where ncc.centroc_cliente_id = :idCliente "
            + "and ncc.de_jornada_id = :idJornada",nativeQuery=true)
    Integer findJornadaXColaborador(Integer idCliente, Integer idJornada);

    @Query(value = "SELECT colaborador.fecha_fin_ultimo_pago,colaborador.ppp_snm,colaborador.estatus_baja_id,colaborador.salario_diario_integrado,colaborador.ppp_monto_complementario,colaborador.ppp_sbm,colaborador.fecha_alta_imss,colaborador.salario_diario_integrado, colaborador.jefe_inmediato_persona_id,colaborador.fecha_contrato,colaborador.salario_diario,colaborador.fecha_inicio,colaborador.fecha_fin,colaborador.de_fecha_antiguedad,colaborador.de_es_sindicalizado,colaborador.su_es_subcontratado,colaborador.su_porcentaje,colaborador.sueldo_bruto_mensual,colaborador.num_empleado,colaborador.sbc,colaborador.dias_vacaciones,colaborador.ba_fecha_para_calculo,colaborador.ba_ultimo_dia,colaborador.ba_notas,colaborador.es_activo,colaborador.de_tipo_jornada_id,colaborador.sueldo_neto_mensual,colaborador.su_subcontratista,colaborador.de_tipo_regimen_contratacion_id,colaborador.de_area_geografica_id,colaborador.de_c_estado,colaborador.metodo_pago_id,colaborador.ba_motivo_baja_id, colaborador.su_subcontratista_id,colaborador.puesto_id,colaborador.centroc_cliente_id,colaborador.de_jornada_id,colaborador.politica_id,colaborador.grupo_nomina_id,colaborador.ba_tipo_baja_id,colaborador.tipo_compensacion_id,colaborador.sede_id,colaborador.de_tipo_contrato_id,colaborador.area_id,colaborador.persona_id," +
            "puestoId.descripcion AS puestoIddescripcion,puestoId.nombre_corto AS puestoIdnombre_corto,puestoId.es_activo AS puestoIdes_activo,puestoId.fecha_alta AS puestoIdfecha_alta,puestoId.centroc_cliente_id AS puestoIdcentroc_cliente_id,puestoId.puesto_id_reporta AS puestoIdpuesto_id_reporta," +
            "centrocClienteId.curp AS centrocClienteIdcurp,centrocClienteId.rfc AS centrocClienteIdrfc,centrocClienteId.razon_social AS centrocClienteIdrazon_social,centrocClienteId.nombre AS centrocClienteIdnombre,centrocClienteId.fecha_constitucion AS centrocClienteIdfecha_constitucion,centrocClienteId.es_activo AS centrocClienteIdes_activo,centrocClienteId.centro_costos_centroc_cliente_id AS centrocClienteIdcentro_costos_centroc_cliente_id,centrocClienteId.cc_url_logo AS centrocClienteIdcc_url_logo,centrocClienteId.fecha_alta AS centrocClienteIdfecha_alta,centrocClienteId.em_c_regimenfiscal AS centrocClienteIdem_c_regimenfiscal,centrocClienteId.base_periodo_id AS centrocClienteIdbase_periodo_id,centrocClienteId.c_actividad_economica AS centrocClienteIdc_actividad_economica,centrocClienteId.certificado_sello_digital_id AS centrocClienteIdcertificado_sello_digital_id,centrocClienteId.multiempresa AS centrocClienteIdmultiempresa, centrocClienteId.pago_complementario as centrocClienteIdpago_complementario," +
            "areaId.descripcion AS areaIddescripcion,areaId.nombre_corto AS areaIdnombre_corto,areaId.fecha_alta AS areaIdfecha_alta,areaId.es_activo AS areaIdes_activo,areaId.area_id_adscripcion AS areaIdarea_id_adscripcion,areaId.centroc_cliente_id AS areaIdcentroc_cliente_id," +
            "sedeId.descripcion AS sedeIddescripcion,sedeId.nombre_corto AS sedeIdnombre_corto,sedeId.es_activo AS sedeIdes_activo,sedeId.fecha_alta AS sedeIdfecha_alta,sedeId.centroc_cliente_id AS sedeIdcentroc_cliente_id," +
            "personaId.url_imagen AS personaIdurl_imagen, personaId.ci_puesto AS personaIdci_puesto, personaId.iba_num_hijos AS personaIdiba_num_hijos,personaId.ce_telefono AS personaIdce_telefono,personaId.ci_telefono AS personaIdci_telefono,personaId.ci_extension AS personaIdci_extension,personaId.curp AS personaIdcurp,personaId.rfc AS personaIdrfc,personaId.nombre AS personaIdnombre,personaId.apellido_pat AS personaIdapellido_pat,personaId.apellido_mat AS personaIdapellido_mat,personaId.email_corp AS personaIdemail_corp,personaId.genero AS personaIdgenero,personaId.nss AS personaIdnss,personaId.ce_nombre AS personaIdce_nombre,personaId.ce_e_mail AS personaIdce_e_mail,personaId.rl_url_firma AS personaIdrl_url_firma,personaId.ci_email_personal AS personaIdci_email_personal,personaId.ce_apellido_paterno AS personaIdce_apellido_paterno,personaId.ce_apellido_materno AS personaIdce_apellido_materno,personaId.iba_estado_civil AS personaIdiba_estado_civil,personaId.url_linkedin AS personaIdurl_linkedin,personaId.fecha_nace AS personaIdfecha_nace,personaId.fecha_alta AS personaIdfecha_alta,personaId.es_activo AS personaIdes_activo,personaId.tiene_curp AS personaIdtiene_curp,personaId.tiene_rfc AS personaIdtiene_rfc,personaId.tiene_nss AS personaIdtiene_nss,personaId.iba_tiene_hijos AS personaIdiba_tiene_hijos,personaId.invitar_empleado AS personaIdinvitar_empleado,personaId.iba_nacionalidad_id AS personaIdiba_nacionalidad_id,personaId.tipo_persona_id AS personaIdtipo_persona_id,personaId.tipo_representante_id AS personaIdtipo_representante_id,personaId.representante_legal_centroc_cliente_id AS personaIdrepresentante_legal_centroc_cliente_id,personaId.ce_parentesco_id AS personaIdce_parentesco_id,personaId.celular AS personaIdcelular, personaId.poder_notarial AS personaIdpoder_notarial, personaId.facultad_poder_id AS  personaIdfacultad_poder_id " +
            "FROM nco_contrato_colaborador colaborador " +
            "INNER JOIN (SELECT persona_id,MAX(fecha_inicio) fecha FROM nco_contrato_colaborador GROUP BY persona_id) colaborador_fecha " +
            "ON colaborador.fecha_inicio = colaborador_fecha.fecha AND colaborador.persona_id = colaborador_fecha.persona_id " +
            "INNER JOIN ncl_puesto puestoId ON colaborador.puesto_id=puestoId.puesto_id " +
            "INNER JOIN ncl_centroc_cliente centrocClienteId ON colaborador.centroc_cliente_id=centrocClienteId.centroc_cliente_id " +
            "INNER JOIN ncl_area areaId ON colaborador.area_id=areaId.area_id " +
            "LEFT JOIN ncl_sede sedeId ON colaborador.sede_id=sedeId.sede_id " +
            "INNER JOIN nco_persona personaId ON colaborador.persona_id=personaId.persona_id " +
            "WHERE colaborador.centroc_cliente_id = :centrocClienteId " +
            "ORDER BY personaIdapellido_pat ",
            nativeQuery = true)
    @Join(value = "areaId", alias = "areaId")
    @Join(value = "puestoId", alias = "puestoId")
    @Join(value = "sedeId", alias = "sedeId")
    @Join(value = "centrocClienteId", alias = "centrocClienteId")
    @Join(value = "personaId", alias = "personaId")
    List<NcoContratoColaborador> findByCentrocClienteIdCentrocClienteId(Integer centrocClienteId);


    @Query(value = "SELECT colaborador.fecha_fin_ultimo_pago,colaborador.ppp_snm,colaborador.estatus_baja_id,colaborador.salario_diario_integrado,colaborador.ppp_monto_complementario,colaborador.ppp_sbm,colaborador.fecha_alta_imss,colaborador.jefe_inmediato_persona_id,colaborador.fecha_contrato,colaborador.salario_diario,colaborador.fecha_inicio,colaborador.fecha_fin,colaborador.de_fecha_antiguedad,colaborador.de_es_sindicalizado,colaborador.su_es_subcontratado,colaborador.su_porcentaje,colaborador.sueldo_bruto_mensual,colaborador.num_empleado,colaborador.sbc,colaborador.dias_vacaciones,colaborador.ba_fecha_para_calculo,colaborador.ba_ultimo_dia,colaborador.ba_notas,colaborador.es_activo,colaborador.de_tipo_jornada_id,colaborador.sueldo_neto_mensual,colaborador.su_subcontratista,colaborador.de_tipo_regimen_contratacion_id,colaborador.de_area_geografica_id,colaborador.de_c_estado,colaborador.metodo_pago_id,colaborador.ba_motivo_baja_id, colaborador.su_subcontratista_id,colaborador.puesto_id,colaborador.centroc_cliente_id,colaborador.de_jornada_id,colaborador.politica_id,colaborador.grupo_nomina_id,colaborador.ba_tipo_baja_id,colaborador.tipo_compensacion_id,colaborador.sede_id,colaborador.de_tipo_contrato_id,colaborador.area_id,colaborador.persona_id," +
            "puestoId.descripcion AS puestoIddescripcion,puestoId.nombre_corto AS puestoIdnombre_corto,puestoId.es_activo AS puestoIdes_activo,puestoId.fecha_alta AS puestoIdfecha_alta,puestoId.centroc_cliente_id AS puestoIdcentroc_cliente_id,puestoId.puesto_id_reporta AS puestoIdpuesto_id_reporta," +
            "centrocClienteId.curp AS centrocClienteIdcurp,centrocClienteId.rfc AS centrocClienteIdrfc,centrocClienteId.razon_social AS centrocClienteIdrazon_social,centrocClienteId.nombre AS centrocClienteIdnombre,centrocClienteId.fecha_constitucion AS centrocClienteIdfecha_constitucion,centrocClienteId.es_activo AS centrocClienteIdes_activo,centrocClienteId.centro_costos_centroc_cliente_id AS centrocClienteIdcentro_costos_centroc_cliente_id,centrocClienteId.cc_url_logo AS centrocClienteIdcc_url_logo,centrocClienteId.fecha_alta AS centrocClienteIdfecha_alta,centrocClienteId.em_c_regimenfiscal AS centrocClienteIdem_c_regimenfiscal,centrocClienteId.base_periodo_id AS centrocClienteIdbase_periodo_id,centrocClienteId.c_actividad_economica AS centrocClienteIdc_actividad_economica,centrocClienteId.certificado_sello_digital_id AS centrocClienteIdcertificado_sello_digital_id,centrocClienteId.multiempresa AS centrocClienteIdmultiempresa, centrocClienteId.pago_complementario as centrocClienteIdpago_complementario, " +
            "areaId.descripcion AS areaIddescripcion,areaId.nombre_corto AS areaIdnombre_corto,areaId.fecha_alta AS areaIdfecha_alta,areaId.es_activo AS areaIdes_activo,areaId.area_id_adscripcion AS areaIdarea_id_adscripcion,areaId.centroc_cliente_id AS areaIdcentroc_cliente_id," +
            "sedeId.descripcion AS sedeIddescripcion,sedeId.nombre_corto AS sedeIdnombre_corto,sedeId.es_activo AS sedeIdes_activo,sedeId.fecha_alta AS sedeIdfecha_alta,sedeId.centroc_cliente_id AS sedeIdcentroc_cliente_id," +
            "personaId.url_imagen AS personaIdurl_imagen,personaId.ci_puesto AS personaIdci_puesto, personaId.iba_num_hijos AS personaIdiba_num_hijos,personaId.ce_telefono AS personaIdce_telefono,personaId.ci_telefono AS personaIdci_telefono,personaId.ci_extension AS personaIdci_extension,personaId.curp AS personaIdcurp,personaId.rfc AS personaIdrfc,personaId.nombre AS personaIdnombre,personaId.apellido_pat AS personaIdapellido_pat,personaId.apellido_mat AS personaIdapellido_mat,personaId.email_corp AS personaIdemail_corp,personaId.genero AS personaIdgenero,personaId.nss AS personaIdnss,personaId.ce_nombre AS personaIdce_nombre,personaId.ce_e_mail AS personaIdce_e_mail,personaId.rl_url_firma AS personaIdrl_url_firma,personaId.ci_email_personal AS personaIdci_email_personal,personaId.ce_apellido_paterno AS personaIdce_apellido_paterno,personaId.ce_apellido_materno AS personaIdce_apellido_materno,personaId.iba_estado_civil AS personaIdiba_estado_civil,personaId.url_linkedin AS personaIdurl_linkedin,personaId.fecha_nace AS personaIdfecha_nace,personaId.fecha_alta AS personaIdfecha_alta,personaId.es_activo AS personaIdes_activo,personaId.tiene_curp AS personaIdtiene_curp,personaId.tiene_rfc AS personaIdtiene_rfc,personaId.tiene_nss AS personaIdtiene_nss,personaId.iba_tiene_hijos AS personaIdiba_tiene_hijos,personaId.invitar_empleado AS personaIdinvitar_empleado,personaId.iba_nacionalidad_id AS personaIdiba_nacionalidad_id,personaId.tipo_persona_id AS personaIdtipo_persona_id,personaId.tipo_representante_id AS personaIdtipo_representante_id,personaId.representante_legal_centroc_cliente_id AS personaIdrepresentante_legal_centroc_cliente_id,personaId.ce_parentesco_id AS personaIdce_parentesco_id,personaId.celular AS personaIdcelular,personaId.poder_notarial AS personaIdpoder_notarial, personaId.facultad_poder_id AS  personaIdfacultad_poder_id, " +
            "metodoId.descripcion AS metodoPagoIddescripcion,metodoId.nombre_corto AS metodoPagoIdnombre_corto,metodoId.fecha_alta AS metodoPagoIdfecha_alta,metodoId.es_activo AS metodoPagoIdes_activo, " +
            "tipoRegimenContratacionId.descripcion AS tipoRegimenContratacionIddescripcion,tipoRegimenContratacionId.fecha_inicio AS tipoRegimenContratacionIdfecha_inicio,tipoRegimenContratacionId.fecha_fin AS tipoRegimenContratacionIdfecha_fin,tipoRegimenContratacionId.es_activo AS tipoRegimenContratacionIdes_activo, " +
            "jornadaId.tipo_jornada_id AS jornadaIdtipo_jornada_id,jornadaId.nombre AS jornadaIdnombre,jornadaId.mismo_horario AS jornadaIdmismo_horario,jornadaId.horario_comida AS jornadaIdhorario_comida,jornadaId.incidir_asistencias AS jornadaIdincidir_asistencias,jornadaId.hora_entrada AS jornadaIdhora_entrada,jornadaId.hora_inicio_comida AS jornadaIdhora_inicio_comida,jornadaId.hora_fin_comida AS jornadaIdhora_fin_comida,jornadaId.hora_salida AS jornadaIdhora_salida,jornadaId.es_activo AS jornadaIdes_activo,jornadaId.centroc_cliente_id AS jornadaIdcentroc_cliente_id,jornadaId.an_minutos_tolerancia AS jornadaIdan_minutos_tolerancia,jornadaId.an_hay_tolerancia AS jornadaIdan_hay_tolerancia,jornadaId.registro_prima_dominical_auto AS jornadaIdregistro_prima_dominical_auto,jornadaId.registro_descanso_laboral_auto AS jornadaIdregistro_descanso_laboral_auto,jornadaId.an_permite_justificar_retardo AS jornadaIdan_permite_justificar_retardo,jornadaId.solo_un_registro_dia AS jornadaIdsolo_un_registro_dia,jornadaId.para_dias_parcialmente_laborados AS jornadaIdpara_dias_parcialmente_laborados,jornadaId.he_solicitud_horas_extra AS jornadaIdhe_solicitud_horas_extra,jornadaId.he_minutos AS jornadaIdhe_minutos,jornadaId.suma_horas_jornada_id AS jornadaIdsuma_horas_jornada_id, " +
            "estadoId.clave_estado AS estadoIdclave_estado, estadoId.es_activo AS estadoIdes_activo,estadoId.fecha_alta AS estadoIdfecha_alta,estadoId.c_estado AS estadoIdc_estado,estadoId.d_estado AS estadoIdd_estado, " +
            "politicaId.calculo_antiguedadx_id AS politicaIdcalculo_antiguedadx_id, politicaId.nombre AS politicaIdnombre,politicaId.es_activo AS politicaIdes_activo,politicaId.nombre_corto AS politicaIdnombre_corto, politicaId.dias_economicos AS politicaIddias_economicos, politicaId.prima_aniversario AS politicaIdprima_aniversario, politicaId.descuenta_faltas AS politicaIddescuenta_faltas, politicaId.descuenta_incapacidades AS politicaIddescuenta_incapacidades, politicaId.costo_vales_restaurante AS politicaIdcosto_vales_restaurante, politicaId.descuento_prop_7o_dia AS politicaIddescuento_prop_7o_dia,politicaId.es_activo AS politicaIdes_activo, politicaId.centroc_cliente_id AS politicaIdcentroc_cliente_id, politicaId.es_estandar AS politicaIdes_estandar, " +
            "grupoNominaId.pago_complementario AS grupoNominaIdpago_complementario, grupoNominaId.nombre AS grupoNominaIdnombre,grupoNominaId.nombre_corto AS grupoNominaIdnombre_corto,grupoNominaId.esquema_pago_id AS grupoNominaIdesquema_pago_id,grupoNominaId.centroc_cliente_id AS grupoNominaIdcentroc_cliente_id,grupoNominaId.moneda_id AS grupoNominaIdmoneda_id,grupoNominaId.periodicidad_pago_id AS grupoNominaIdperiodicidad_pago_id,grupoNominaId.isr_aguinaldo_reglamento AS grupoNominaIdisr_aguinaldo_reglamento,grupoNominaId.es_automatica AS grupoNominaIdes_automatica,grupoNominaId.es_activo AS grupoNominaIdes_activo,grupoNominaId.es_predeterminado AS grupoNominaIdes_predeterminado,grupoNominaId.ajuste_mensual_isr AS grupoNominaIdajuste_mensual_isr,grupoNominaId.base_periodo_id AS grupoNominaIdbase_periodo_id,grupoNominaId.periodo_aguinaldo_id AS grupoNominaIdperiodo_aguinaldo_id,grupoNominaId.manera_calcular_subsidio AS grupoNominaIdmanera_calcular_subsidio,grupoNominaId.ajustar_base_gravable_faltantes AS grupoNominaIdajustar_base_gravable_faltantes,grupoNominaId.cuenta_banco_id AS grupoNominaIdcuenta_banco_id, " +
            "tipoCompensacionId.descripcion AS tipoCompensacionIddescripcion,tipoCompensacionId.nombre_corto AS tipoCompensacionIdnombre_corto,tipoCompensacionId.es_activo AS tipoCompensacionIdes_activo,tipoCompensacionId.fecha_alta AS tipoCompensacionIdfecha_alta " +
            "FROM nco_contrato_colaborador colaborador " +
            "INNER JOIN (SELECT persona_id,MAX(fecha_inicio) fecha FROM nco_contrato_colaborador GROUP BY persona_id) colaborador_fecha " +
            "ON colaborador.fecha_inicio = colaborador_fecha.fecha AND colaborador.persona_id = colaborador_fecha.persona_id " +
            "INNER JOIN ncl_puesto puestoId ON colaborador.puesto_id=puestoId.puesto_id " +
            "INNER JOIN ncl_centroc_cliente centrocClienteId ON colaborador.centroc_cliente_id=centrocClienteId.centroc_cliente_id " +
            "INNER JOIN ncl_area areaId ON colaborador.area_id=areaId.area_id " +
            "LEFT JOIN ncl_sede sedeId ON colaborador.sede_id=sedeId.sede_id " +
            "INNER JOIN nco_persona personaId ON colaborador.persona_id=personaId.persona_id " +
            "INNER JOIN cat_metodo_pago metodoId on colaborador.metodo_pago_id = metodoId.metodo_pago_id " +
            "INNER JOIN cs_tipo_regimen_contratacion tipoRegimenContratacionId on colaborador.de_tipo_regimen_contratacion_id = tipoRegimenContratacionId.tipo_regimen_contratacion_id " +
            "INNER JOIN ncl_jornada jornadaId on colaborador.de_jornada_id = jornadaId.jornada_id " +
            "INNER JOIN cat_estado estadoId on colaborador.de_c_estado = estadoId.c_estado " +
            "INNER JOIN ncl_politica politicaId on colaborador.politica_id = politicaId.politica_id " +
            "INNER JOIN ncl_grupo_nomina grupoNominaId on colaborador.grupo_nomina_id = grupoNominaId.grupo_nomina_id " +
            "INNER JOIN cat_tipo_compensacion tipoCompensacionId on colaborador.tipo_compensacion_id = tipoCompensacionId.tipo_compensacion_id " +
            "AND colaborador.persona_id = :personaId " +
            "ORDER BY colaborador.persona_id",
            nativeQuery = true)
    @Join(value = "tipoCompensacionId", alias = "tipoCompensacionId")
    @Join(value = "grupoNominaId", alias = "grupoNominaId")
    @Join(value = "politicaId", alias = "politicaId")
    @Join(value = "estadoId", alias = "estadoId")
    @Join(value = "jornadaId", alias = "jornadaId")
    @Join(value = "tipoRegimenContratacionId", alias = "tipoRegimenContratacionId")
    @Join(value = "metodoPagoId", alias = "metodoPagoId")
    @Join(value = "areaId", alias = "areaId")
    @Join(value = "puestoId", alias = "puestoId")
    @Join(value = "sedeId", alias = "sedeId")
    @Join(value = "centrocClienteId", alias = "centrocClienteId")
    @Join(value = "personaId", alias = "personaId")
    NcoContratoColaborador findByPersonaIdPersonaId(Integer personaId);


    @Query(value = "SELECT colaborador.fecha_fin_ultimo_pago,colaborador.ppp_snm,colaborador.estatus_baja_id,colaborador.salario_diario_integrado,colaborador.ppp_monto_complementario,colaborador.ppp_sbm,colaborador.fecha_alta_imss,colaborador.jefe_inmediato_persona_id,colaborador.fecha_contrato,colaborador.salario_diario,colaborador.fecha_inicio,colaborador.fecha_fin,colaborador.de_fecha_antiguedad,colaborador.de_es_sindicalizado,colaborador.su_es_subcontratado,colaborador.su_porcentaje,colaborador.sueldo_bruto_mensual,colaborador.num_empleado,colaborador.sbc,colaborador.dias_vacaciones,colaborador.ba_fecha_para_calculo,colaborador.ba_ultimo_dia,colaborador.ba_notas,colaborador.es_activo,colaborador.de_tipo_jornada_id,colaborador.sueldo_neto_mensual,colaborador.su_subcontratista,colaborador.de_tipo_regimen_contratacion_id,colaborador.de_area_geografica_id,colaborador.de_c_estado,colaborador.metodo_pago_id,colaborador.ba_motivo_baja_id, colaborador.su_subcontratista_id,colaborador.puesto_id,colaborador.centroc_cliente_id,colaborador.de_jornada_id,colaborador.politica_id,colaborador.grupo_nomina_id,colaborador.ba_tipo_baja_id,colaborador.tipo_compensacion_id,colaborador.sede_id,colaborador.de_tipo_contrato_id,colaborador.area_id,colaborador.persona_id," +
            "puestoId.descripcion AS puestoIddescripcion,puestoId.nombre_corto AS puestoIdnombre_corto,puestoId.es_activo AS puestoIdes_activo,puestoId.fecha_alta AS puestoIdfecha_alta,puestoId.centroc_cliente_id AS puestoIdcentroc_cliente_id,puestoId.puesto_id_reporta AS puestoIdpuesto_id_reporta," +
            "centrocClienteId.curp AS centrocClienteIdcurp,centrocClienteId.rfc AS centrocClienteIdrfc,centrocClienteId.razon_social AS centrocClienteIdrazon_social,centrocClienteId.nombre AS centrocClienteIdnombre,centrocClienteId.fecha_constitucion AS centrocClienteIdfecha_constitucion,centrocClienteId.es_activo AS centrocClienteIdes_activo,centrocClienteId.centro_costos_centroc_cliente_id AS centrocClienteIdcentro_costos_centroc_cliente_id,centrocClienteId.cc_url_logo AS centrocClienteIdcc_url_logo,centrocClienteId.fecha_alta AS centrocClienteIdfecha_alta,centrocClienteId.em_c_regimenfiscal AS centrocClienteIdem_c_regimenfiscal,centrocClienteId.base_periodo_id AS centrocClienteIdbase_periodo_id,centrocClienteId.c_actividad_economica AS centrocClienteIdc_actividad_economica,centrocClienteId.certificado_sello_digital_id AS centrocClienteIdcertificado_sello_digital_id,centrocClienteId.multiempresa AS centrocClienteIdmultiempresa, centrocClienteId.pago_complementario as centrocClienteIdpago_complementario, " +
            "areaId.descripcion AS areaIddescripcion,areaId.nombre_corto AS areaIdnombre_corto,areaId.fecha_alta AS areaIdfecha_alta,areaId.es_activo AS areaIdes_activo,areaId.area_id_adscripcion AS areaIdarea_id_adscripcion,areaId.centroc_cliente_id AS areaIdcentroc_cliente_id," +
            "sedeId.descripcion AS sedeIddescripcion,sedeId.nombre_corto AS sedeIdnombre_corto,sedeId.es_activo AS sedeIdes_activo,sedeId.fecha_alta AS sedeIdfecha_alta,sedeId.centroc_cliente_id AS sedeIdcentroc_cliente_id," +
            "personaId.url_imagen AS personaIdurl_imagen,personaId.ci_puesto AS personaIdci_puesto, personaId.iba_num_hijos AS personaIdiba_num_hijos,personaId.ce_telefono AS personaIdce_telefono,personaId.ci_telefono AS personaIdci_telefono,personaId.ci_extension AS personaIdci_extension,personaId.curp AS personaIdcurp,personaId.rfc AS personaIdrfc,personaId.nombre AS personaIdnombre,personaId.apellido_pat AS personaIdapellido_pat,personaId.apellido_mat AS personaIdapellido_mat,personaId.email_corp AS personaIdemail_corp,personaId.genero AS personaIdgenero,personaId.nss AS personaIdnss,personaId.ce_nombre AS personaIdce_nombre,personaId.ce_e_mail AS personaIdce_e_mail,personaId.rl_url_firma AS personaIdrl_url_firma,personaId.ci_email_personal AS personaIdci_email_personal,personaId.ce_apellido_paterno AS personaIdce_apellido_paterno,personaId.ce_apellido_materno AS personaIdce_apellido_materno,personaId.iba_estado_civil AS personaIdiba_estado_civil,personaId.url_linkedin AS personaIdurl_linkedin,personaId.fecha_nace AS personaIdfecha_nace,personaId.fecha_alta AS personaIdfecha_alta,personaId.es_activo AS personaIdes_activo,personaId.tiene_curp AS personaIdtiene_curp,personaId.tiene_rfc AS personaIdtiene_rfc,personaId.tiene_nss AS personaIdtiene_nss,personaId.iba_tiene_hijos AS personaIdiba_tiene_hijos,personaId.invitar_empleado AS personaIdinvitar_empleado,personaId.iba_nacionalidad_id AS personaIdiba_nacionalidad_id,personaId.tipo_persona_id AS personaIdtipo_persona_id,personaId.tipo_representante_id AS personaIdtipo_representante_id,personaId.representante_legal_centroc_cliente_id AS personaIdrepresentante_legal_centroc_cliente_id,personaId.ce_parentesco_id AS personaIdce_parentesco_id,personaId.celular AS personaIdcelular, personaId.poder_notarial AS personaIdpoder_notarial, personaId.facultad_poder_id AS  personaIdfacultad_poder_id " +
            "FROM nco_contrato_colaborador colaborador " +
            "INNER JOIN (SELECT persona_id,MAX(fecha_inicio) fecha FROM nco_contrato_colaborador GROUP BY persona_id) colaborador_fecha " +
            "ON colaborador.fecha_inicio = colaborador_fecha.fecha AND colaborador.persona_id = colaborador_fecha.persona_id " +
            "INNER JOIN ncl_puesto puestoId ON colaborador.puesto_id=puestoId.puesto_id " +
            "INNER JOIN ncl_centroc_cliente centrocClienteId ON colaborador.centroc_cliente_id=centrocClienteId.centroc_cliente_id " +
            "INNER JOIN ncl_area areaId ON colaborador.area_id=areaId.area_id " +
            "LEFT JOIN ncl_sede sedeId ON colaborador.sede_id=sedeId.sede_id " +
            "INNER JOIN nco_persona personaId ON colaborador.persona_id=personaId.persona_id " +
            "AND colaborador.grupo_nomina_id = :grupoNominaId " +
            "AND colaborador.es_activo " +
            "ORDER BY colaborador.persona_id",
            nativeQuery = true)
    @Join(value = "areaId", alias = "areaId")
    @Join(value = "puestoId", alias = "puestoId")
    @Join(value = "sedeId", alias = "sedeId")
    @Join(value = "centrocClienteId", alias = "centrocClienteId")
    @Join(value = "personaId", alias = "personaId")
    List<NcoContratoColaborador> findByGrupoNominaIdGrupoNominaId(Integer grupoNominaId);

    @Query(value = "SELECT colaborador.fecha_fin_ultimo_pago,colaborador.ppp_snm,colaborador.estatus_baja_id,colaborador.salario_diario_integrado,colaborador.ppp_monto_complementario,colaborador.ppp_sbm,colaborador.fecha_alta_imss,colaborador.jefe_inmediato_persona_id,colaborador.fecha_contrato,colaborador.salario_diario,colaborador.fecha_inicio,colaborador.fecha_fin,colaborador.de_fecha_antiguedad,colaborador.de_es_sindicalizado,colaborador.su_es_subcontratado,colaborador.su_porcentaje,colaborador.sueldo_bruto_mensual,colaborador.num_empleado,colaborador.sbc,colaborador.dias_vacaciones,colaborador.ba_fecha_para_calculo,colaborador.ba_ultimo_dia,colaborador.ba_notas,colaborador.es_activo,colaborador.de_tipo_jornada_id,colaborador.sueldo_neto_mensual,colaborador.su_subcontratista,colaborador.de_tipo_regimen_contratacion_id,colaborador.de_area_geografica_id,colaborador.de_c_estado,colaborador.metodo_pago_id,colaborador.ba_motivo_baja_id, colaborador.su_subcontratista_id,colaborador.puesto_id,colaborador.centroc_cliente_id,colaborador.de_jornada_id,colaborador.politica_id,colaborador.grupo_nomina_id,colaborador.ba_tipo_baja_id,colaborador.tipo_compensacion_id,colaborador.sede_id,colaborador.de_tipo_contrato_id,colaborador.area_id,colaborador.persona_id," +
            "puestoId.descripcion AS puestoIddescripcion,puestoId.nombre_corto AS puestoIdnombre_corto,puestoId.es_activo AS puestoIdes_activo,puestoId.fecha_alta AS puestoIdfecha_alta,puestoId.centroc_cliente_id AS puestoIdcentroc_cliente_id,puestoId.puesto_id_reporta AS puestoIdpuesto_id_reporta," +
            "centrocClienteId.curp AS centrocClienteIdcurp,centrocClienteId.rfc AS centrocClienteIdrfc,centrocClienteId.razon_social AS centrocClienteIdrazon_social,centrocClienteId.nombre AS centrocClienteIdnombre,centrocClienteId.fecha_constitucion AS centrocClienteIdfecha_constitucion,centrocClienteId.es_activo AS centrocClienteIdes_activo,centrocClienteId.centro_costos_centroc_cliente_id AS centrocClienteIdcentro_costos_centroc_cliente_id,centrocClienteId.cc_url_logo AS centrocClienteIdcc_url_logo,centrocClienteId.fecha_alta AS centrocClienteIdfecha_alta,centrocClienteId.em_c_regimenfiscal AS centrocClienteIdem_c_regimenfiscal,centrocClienteId.base_periodo_id AS centrocClienteIdbase_periodo_id,centrocClienteId.c_actividad_economica AS centrocClienteIdc_actividad_economica,centrocClienteId.certificado_sello_digital_id AS centrocClienteIdcertificado_sello_digital_id,centrocClienteId.multiempresa AS centrocClienteIdmultiempresa, centrocClienteId.pago_complementario as centrocClienteIdpago_complementario, " +
            "areaId.descripcion AS areaIddescripcion,areaId.nombre_corto AS areaIdnombre_corto,areaId.fecha_alta AS areaIdfecha_alta,areaId.es_activo AS areaIdes_activo,areaId.area_id_adscripcion AS areaIdarea_id_adscripcion,areaId.centroc_cliente_id AS areaIdcentroc_cliente_id," +
            "sedeId.descripcion AS sedeIddescripcion,sedeId.nombre_corto AS sedeIdnombre_corto,sedeId.es_activo AS sedeIdes_activo,sedeId.fecha_alta AS sedeIdfecha_alta,sedeId.centroc_cliente_id AS sedeIdcentroc_cliente_id," +
            "personaId.url_imagen AS personaIdurl_imagen,personaId.ci_puesto AS personaIdci_puesto, personaId.iba_num_hijos AS personaIdiba_num_hijos,personaId.ce_telefono AS personaIdce_telefono,personaId.ci_telefono AS personaIdci_telefono,personaId.ci_extension AS personaIdci_extension,personaId.curp AS personaIdcurp,personaId.rfc AS personaIdrfc,personaId.nombre AS personaIdnombre,personaId.apellido_pat AS personaIdapellido_pat,personaId.apellido_mat AS personaIdapellido_mat,personaId.email_corp AS personaIdemail_corp,personaId.genero AS personaIdgenero,personaId.nss AS personaIdnss,personaId.ce_nombre AS personaIdce_nombre,personaId.ce_e_mail AS personaIdce_e_mail,personaId.rl_url_firma AS personaIdrl_url_firma,personaId.ci_email_personal AS personaIdci_email_personal,personaId.ce_apellido_paterno AS personaIdce_apellido_paterno,personaId.ce_apellido_materno AS personaIdce_apellido_materno,personaId.iba_estado_civil AS personaIdiba_estado_civil,personaId.url_linkedin AS personaIdurl_linkedin,personaId.fecha_nace AS personaIdfecha_nace,personaId.fecha_alta AS personaIdfecha_alta,personaId.es_activo AS personaIdes_activo,personaId.tiene_curp AS personaIdtiene_curp,personaId.tiene_rfc AS personaIdtiene_rfc,personaId.tiene_nss AS personaIdtiene_nss,personaId.iba_tiene_hijos AS personaIdiba_tiene_hijos,personaId.invitar_empleado AS personaIdinvitar_empleado,personaId.iba_nacionalidad_id AS personaIdiba_nacionalidad_id,personaId.tipo_persona_id AS personaIdtipo_persona_id,personaId.tipo_representante_id AS personaIdtipo_representante_id,personaId.representante_legal_centroc_cliente_id AS personaIdrepresentante_legal_centroc_cliente_id,personaId.ce_parentesco_id AS personaIdce_parentesco_id,personaId.celular AS personaIdcelular, personaId.poder_notarial AS personaIdpoder_notarial, personaId.facultad_poder_id AS  personaIdfacultad_poder_id " +
            "FROM nco_contrato_colaborador colaborador " +
            "INNER JOIN (SELECT persona_id,MAX(fecha_inicio) fecha FROM nco_contrato_colaborador GROUP BY persona_id) colaborador_fecha " +
            "ON colaborador.fecha_inicio = colaborador_fecha.fecha AND colaborador.persona_id = colaborador_fecha.persona_id " +
            "INNER JOIN ncl_puesto puestoId ON colaborador.puesto_id=puestoId.puesto_id " +
            "INNER JOIN ncl_centroc_cliente centrocClienteId ON colaborador.centroc_cliente_id=centrocClienteId.centroc_cliente_id " +
            "INNER JOIN ncl_area areaId ON colaborador.area_id=areaId.area_id " +
            "LEFT JOIN ncl_sede sedeId ON colaborador.sede_id=sedeId.sede_id " +
            "INNER JOIN nco_persona personaId ON colaborador.persona_id=personaId.persona_id " +
            "AND colaborador.centroc_cliente_id = :centrocClienteId " +
            "AND colaborador.es_activo = :activo " +
            "ORDER BY colaborador.persona_id",
            nativeQuery = true)
    @Join(value = "areaId", alias = "areaId")
    @Join(value = "puestoId", alias = "puestoId")
    @Join(value = "sedeId", alias = "sedeId")
    @Join(value = "centrocClienteId", alias = "centrocClienteId")
    @Join(value = "personaId", alias = "personaId")
    List<NcoContratoColaborador> findByCentrocClienteIdCentrocClienteIdAndEsActivo(Integer centrocClienteId, boolean activo);

    @Query(value = "SELECT colaborador.fecha_fin_ultimo_pago,colaborador.ppp_snm,colaborador.estatus_baja_id,colaborador.salario_diario_integrado,colaborador.ppp_monto_complementario,colaborador.ppp_sbm,colaborador.fecha_alta_imss,colaborador.jefe_inmediato_persona_id,colaborador.fecha_contrato,colaborador.salario_diario,colaborador.fecha_inicio,colaborador.fecha_fin,colaborador.de_fecha_antiguedad,colaborador.de_es_sindicalizado,colaborador.su_es_subcontratado,colaborador.su_porcentaje,colaborador.sueldo_bruto_mensual,colaborador.num_empleado,colaborador.sbc,colaborador.dias_vacaciones,colaborador.ba_fecha_para_calculo,colaborador.ba_ultimo_dia,colaborador.ba_notas,colaborador.es_activo,colaborador.de_tipo_jornada_id,colaborador.sueldo_neto_mensual,colaborador.su_subcontratista,colaborador.de_tipo_regimen_contratacion_id,colaborador.de_area_geografica_id,colaborador.de_c_estado,colaborador.metodo_pago_id,colaborador.ba_motivo_baja_id, colaborador.su_subcontratista_id,colaborador.puesto_id,colaborador.centroc_cliente_id,colaborador.de_jornada_id,colaborador.politica_id,colaborador.grupo_nomina_id,colaborador.ba_tipo_baja_id,colaborador.tipo_compensacion_id,colaborador.sede_id,colaborador.de_tipo_contrato_id,colaborador.area_id,colaborador.persona_id," +
            "puestoId.descripcion AS puestoIddescripcion,puestoId.nombre_corto AS puestoIdnombre_corto,puestoId.es_activo AS puestoIdes_activo,puestoId.fecha_alta AS puestoIdfecha_alta,puestoId.centroc_cliente_id AS puestoIdcentroc_cliente_id,puestoId.puesto_id_reporta AS puestoIdpuesto_id_reporta," +
            "centrocClienteId.curp AS centrocClienteIdcurp,centrocClienteId.rfc AS centrocClienteIdrfc,centrocClienteId.razon_social AS centrocClienteIdrazon_social,centrocClienteId.nombre AS centrocClienteIdnombre,centrocClienteId.fecha_constitucion AS centrocClienteIdfecha_constitucion,centrocClienteId.es_activo AS centrocClienteIdes_activo,centrocClienteId.centro_costos_centroc_cliente_id AS centrocClienteIdcentro_costos_centroc_cliente_id,centrocClienteId.cc_url_logo AS centrocClienteIdcc_url_logo,centrocClienteId.fecha_alta AS centrocClienteIdfecha_alta,centrocClienteId.em_c_regimenfiscal AS centrocClienteIdem_c_regimenfiscal,centrocClienteId.base_periodo_id AS centrocClienteIdbase_periodo_id,centrocClienteId.c_actividad_economica AS centrocClienteIdc_actividad_economica,centrocClienteId.certificado_sello_digital_id AS centrocClienteIdcertificado_sello_digital_id,centrocClienteId.multiempresa AS centrocClienteIdmultiempresa, " +
            "areaId.descripcion AS areaIddescripcion,areaId.nombre_corto AS areaIdnombre_corto,areaId.fecha_alta AS areaIdfecha_alta,areaId.es_activo AS areaIdes_activo,areaId.area_id_adscripcion AS areaIdarea_id_adscripcion,areaId.centroc_cliente_id AS areaIdcentroc_cliente_id," +
            "personaId.url_imagen AS personaIdurl_imagen,personaId.ci_puesto AS personaIdci_puesto, personaId.iba_num_hijos AS personaIdiba_num_hijos,personaId.ce_telefono AS personaIdce_telefono,personaId.ci_telefono AS personaIdci_telefono,personaId.ci_extension AS personaIdci_extension,personaId.curp AS personaIdcurp,personaId.rfc AS personaIdrfc,personaId.nombre AS personaIdnombre,personaId.apellido_pat AS personaIdapellido_pat,personaId.apellido_mat AS personaIdapellido_mat,personaId.email_corp AS personaIdemail_corp,personaId.genero AS personaIdgenero,personaId.nss AS personaIdnss,personaId.ce_nombre AS personaIdce_nombre,personaId.ce_e_mail AS personaIdce_e_mail,personaId.rl_url_firma AS personaIdrl_url_firma,personaId.ci_email_personal AS personaIdci_email_personal,personaId.ce_apellido_paterno AS personaIdce_apellido_paterno,personaId.ce_apellido_materno AS personaIdce_apellido_materno,personaId.iba_estado_civil AS personaIdiba_estado_civil,personaId.url_linkedin AS personaIdurl_linkedin,personaId.fecha_nace AS personaIdfecha_nace,personaId.fecha_alta AS personaIdfecha_alta,personaId.es_activo AS personaIdes_activo,personaId.tiene_curp AS personaIdtiene_curp,personaId.tiene_rfc AS personaIdtiene_rfc,personaId.tiene_nss AS personaIdtiene_nss,personaId.iba_tiene_hijos AS personaIdiba_tiene_hijos,personaId.invitar_empleado AS personaIdinvitar_empleado,personaId.iba_nacionalidad_id AS personaIdiba_nacionalidad_id,personaId.tipo_persona_id AS personaIdtipo_persona_id,personaId.tipo_representante_id AS personaIdtipo_representante_id,personaId.representante_legal_centroc_cliente_id AS personaIdrepresentante_legal_centroc_cliente_id,personaId.ce_parentesco_id AS personaIdce_parentesco_id,personaId.celular AS personaIdcelular,personaId.poder_notarial AS personaIdpoder_notarial, personaId.facultad_poder_id AS  personaIdfacultad_poder_id, " +
            "metodoId.descripcion AS metodoPagoIddescripcion,metodoId.nombre_corto AS metodoPagoIdnombre_corto,metodoId.fecha_alta AS metodoPagoIdfecha_alta,metodoId.es_activo AS metodoPagoIdes_activo, " +
            "tipoRegimenContratacionId.descripcion AS tipoRegimenContratacionIddescripcion,tipoRegimenContratacionId.fecha_inicio AS tipoRegimenContratacionIdfecha_inicio,tipoRegimenContratacionId.fecha_fin AS tipoRegimenContratacionIdfecha_fin,tipoRegimenContratacionId.es_activo AS tipoRegimenContratacionIdes_activo, " +
            "jornadaId.tipo_jornada_id AS jornadaIdtipo_jornada_id,jornadaId.nombre AS jornadaIdnombre,jornadaId.mismo_horario AS jornadaIdmismo_horario,jornadaId.horario_comida AS jornadaIdhorario_comida,jornadaId.incidir_asistencias AS jornadaIdincidir_asistencias,jornadaId.hora_entrada AS jornadaIdhora_entrada,jornadaId.hora_inicio_comida AS jornadaIdhora_inicio_comida,jornadaId.hora_fin_comida AS jornadaIdhora_fin_comida,jornadaId.hora_salida AS jornadaIdhora_salida,jornadaId.es_activo AS jornadaIdes_activo,jornadaId.centroc_cliente_id AS jornadaIdcentroc_cliente_id,jornadaId.an_minutos_tolerancia AS jornadaIdan_minutos_tolerancia,jornadaId.an_hay_tolerancia AS jornadaIdan_hay_tolerancia,jornadaId.registro_prima_dominical_auto AS jornadaIdregistro_prima_dominical_auto,jornadaId.registro_descanso_laboral_auto AS jornadaIdregistro_descanso_laboral_auto,jornadaId.an_permite_justificar_retardo AS jornadaIdan_permite_justificar_retardo,jornadaId.solo_un_registro_dia AS jornadaIdsolo_un_registro_dia,jornadaId.para_dias_parcialmente_laborados AS jornadaIdpara_dias_parcialmente_laborados,jornadaId.he_solicitud_horas_extra AS jornadaIdhe_solicitud_horas_extra,jornadaId.he_minutos AS jornadaIdhe_minutos,jornadaId.suma_horas_jornada_id AS jornadaIdsuma_horas_jornada_id, " +
            "estadoId.clave_estado AS estadoIdclave_estado, estadoId.es_activo AS estadoIdes_activo,estadoId.fecha_alta AS estadoIdfecha_alta,estadoId.c_estado AS estadoIdc_estado,estadoId.d_estado AS estadoIdd_estado, " +
            "politicaId.calculo_antiguedadx_id AS politicaIdcalculo_antiguedadx_id, politicaId.nombre AS politicaIdnombre,politicaId.es_activo AS politicaIdes_activo,politicaId.nombre_corto AS politicaIdnombre_corto, politicaId.dias_economicos AS politicaIddias_economicos, politicaId.prima_aniversario AS politicaIdprima_aniversario, politicaId.descuenta_faltas AS politicaIddescuenta_faltas, politicaId.descuenta_incapacidades AS politicaIddescuenta_incapacidades, politicaId.costo_vales_restaurante AS politicaIdcosto_vales_restaurante, politicaId.descuento_prop_7o_dia AS politicaIddescuento_prop_7o_dia,politicaId.es_activo AS politicaIdes_activo, politicaId.centroc_cliente_id AS politicaIdcentroc_cliente_id, politicaId.es_estandar AS politicaIdes_estandar, " +
            "grupoNominaId.pago_complementario AS grupoNominaIdpago_complementario, grupoNominaId.nombre AS grupoNominaIdnombre,grupoNominaId.nombre_corto AS grupoNominaIdnombre_corto,grupoNominaId.esquema_pago_id AS grupoNominaIdesquema_pago_id,grupoNominaId.centroc_cliente_id AS grupoNominaIdcentroc_cliente_id,grupoNominaId.moneda_id AS grupoNominaIdmoneda_id,grupoNominaId.periodicidad_pago_id AS grupoNominaIdperiodicidad_pago_id,grupoNominaId.isr_aguinaldo_reglamento AS grupoNominaIdisr_aguinaldo_reglamento,grupoNominaId.es_automatica AS grupoNominaIdes_automatica,grupoNominaId.es_activo AS grupoNominaIdes_activo,grupoNominaId.es_predeterminado AS grupoNominaIdes_predeterminado,grupoNominaId.ajuste_mensual_isr AS grupoNominaIdajuste_mensual_isr,grupoNominaId.base_periodo_id AS grupoNominaIdbase_periodo_id,grupoNominaId.periodo_aguinaldo_id AS grupoNominaIdperiodo_aguinaldo_id,grupoNominaId.manera_calcular_subsidio AS grupoNominaIdmanera_calcular_subsidio,grupoNominaId.ajustar_base_gravable_faltantes AS grupoNominaIdajustar_base_gravable_faltantes,grupoNominaId.cuenta_banco_id AS grupoNominaIdcuenta_banco_id, " +
            "tipoCompensacionId.descripcion AS tipoCompensacionIddescripcion,tipoCompensacionId.nombre_corto AS tipoCompensacionIdnombre_corto,tipoCompensacionId.es_activo AS tipoCompensacionIdes_activo,tipoCompensacionId.fecha_alta AS tipoCompensacionIdfecha_alta " +
            "FROM nco_contrato_colaborador colaborador " +
            "INNER JOIN (SELECT persona_id,MAX(fecha_inicio) fecha FROM nco_contrato_colaborador GROUP BY persona_id) colaborador_fecha " +
            "ON colaborador.fecha_inicio = colaborador_fecha.fecha AND colaborador.persona_id = colaborador_fecha.persona_id " +
            "INNER JOIN ncl_puesto puestoId ON colaborador.puesto_id=puestoId.puesto_id " +
            "INNER JOIN ncl_centroc_cliente centrocClienteId ON colaborador.centroc_cliente_id=centrocClienteId.centroc_cliente_id " +
            "INNER JOIN ncl_area areaId ON colaborador.area_id=areaId.area_id " +
            "INNER JOIN nco_persona personaId ON colaborador.persona_id=personaId.persona_id " +
            "INNER JOIN cat_metodo_pago metodoId on colaborador.metodo_pago_id = metodoId.metodo_pago_id " +
            "INNER JOIN cs_tipo_regimen_contratacion tipoRegimenContratacionId on colaborador.de_tipo_regimen_contratacion_id = tipoRegimenContratacionId.tipo_regimen_contratacion_id " +
            "INNER JOIN ncl_jornada jornadaId on colaborador.de_jornada_id = jornadaId.jornada_id " +
            "INNER JOIN cat_estado estadoId on colaborador.de_c_estado = estadoId.c_estado " +
            "INNER JOIN ncl_politica politicaId on colaborador.politica_id = politicaId.politica_id " +
            "INNER JOIN ncl_grupo_nomina grupoNominaId on colaborador.grupo_nomina_id = grupoNominaId.grupo_nomina_id " +
            "INNER JOIN cat_tipo_compensacion tipoCompensacionId on colaborador.tipo_compensacion_id = tipoCompensacionId.tipo_compensacion_id " +
            "AND colaborador.centroc_cliente_id = :centrocClienteId " +
            "AND colaborador.es_activo = true  " +
            "AND colaborador.grupo_nomina_id = :grupoNominaId " +
            "AND :fechaPeriodo between colaborador.fecha_contrato and coalesce(colaborador.fecha_fin, :fechaPeriodo) " +
            "ORDER BY colaborador.persona_id",
            nativeQuery = true)
    @Join(value = "tipoCompensacionId", alias = "tipoCompensacionId")
    @Join(value = "grupoNominaId", alias = "grupoNominaId")
    @Join(value = "politicaId", alias = "politicaId")
    @Join(value = "estadoId", alias = "estadoId")
    @Join(value = "jornadaId", alias = "jornadaId")
    @Join(value = "tipoRegimenContratacionId", alias = "tipoRegimenContratacionId")
    @Join(value = "metodoPagoId", alias = "metodoPagoId")
    @Join(value = "areaId", alias = "areaId")
    @Join(value = "puestoId", alias = "puestoId")
    @Join(value = "centrocClienteId", alias = "centrocClienteId")
    @Join(value = "personaId", alias = "personaId")
    List<NcoContratoColaborador> findByCentrocClienteIdCentrocClienteIdAndGrupoNominaIdGrupoNominaIdAndFechaPeriodo(Integer centrocClienteId, Integer grupoNominaId, Date fechaPeriodo);

    @Query(value = "SELECT * FROM nco_contrato_colaborador ncc " +
            "INNER JOIN ncl_area na ON ncc.area_id = na.area_id " +
            "INNER JOIN ncl_puesto p ON ncc.puesto_id = p.puesto_id " +
            "LEFT JOIN ncl_sede ns ON ncc.sede_id = ns.sede_id " +
            "INNER JOIN ncl_centroc_cliente n ON ncc.centroc_cliente_id = n.centroc_cliente_id " +
            "INNER JOIN nco_persona np ON ncc.persona_id = np.persona_id " +
            "INNER JOIN nma_domicilio nd ON np.persona_id = nd.persona_id " +
            "WHERE ncc.persona_id = :personaId",nativeQuery = true)
    NcoContratoColaborador findByPersonaIdNativo(Integer personaId);

    boolean existsByNumEmpleadoAndCentrocClienteIdCentrocClienteId(String numEmpleado, Integer centrocClienteId);

    boolean existsByPersonaIdPersonaId(Integer personaId);

    @Join(value = "areaGeograficaId", alias = "areaGeograficaId")
    @Join(value = "tipoContratoId", alias = "tipoContratoId")
    @Join(value = "tipoCompensacionId", alias = "tipoCompensacionId")
    @Join(value = "grupoNominaId", alias = "grupoNominaId")
    @Join(value = "politicaId", alias = "politicaId")
    @Join(value = "estadoId", alias = "estadoId")
    @Join(value = "jornadaId", alias = "jornadaId")
    @Join(value = "tipoRegimenContratacionId", alias = "tipoRegimenContratacionId")
    @Join(value = "metodoPagoId", alias = "metodoPagoId")
    @Join(value = "areaId", alias = "areaId")
    @Join(value = "puestoId", alias = "puestoId")
    @Join(value = "sedeId", alias = "sedeId", type = Join.Type.LEFT)
    @Join(value = "centrocClienteId", alias = "centrocClienteId")
    @Join(value = "personaId", alias = "personaId")
    Optional<NcoContratoColaborador> findByFechaContratoAndPersonaIdPersonaIdAndCentrocClienteIdCentrocClienteId(Date fechaContrato, Integer personaId, Integer centrocClienteId);

    @Query(value = "SELECT colaborador.fecha_fin_ultimo_pago,colaborador.ppp_snm,colaborador.estatus_baja_id,colaborador.salario_diario_integrado,colaborador.ppp_monto_complementario,colaborador.ppp_sbm,colaborador.fecha_alta_imss,colaborador.jefe_inmediato_persona_id, colaborador.fecha_contrato,colaborador.salario_diario,colaborador.fecha_inicio,colaborador.fecha_fin,colaborador.de_fecha_antiguedad,colaborador.de_es_sindicalizado,colaborador.su_es_subcontratado,colaborador.su_porcentaje,colaborador.sueldo_bruto_mensual,colaborador.num_empleado,colaborador.sbc,colaborador.dias_vacaciones,colaborador.ba_fecha_para_calculo,colaborador.ba_ultimo_dia,colaborador.ba_notas,colaborador.es_activo,colaborador.de_tipo_jornada_id,colaborador.sueldo_neto_mensual,colaborador.su_subcontratista,colaborador.de_tipo_regimen_contratacion_id,colaborador.de_area_geografica_id,colaborador.de_c_estado,colaborador.metodo_pago_id,colaborador.ba_motivo_baja_id, colaborador.su_subcontratista_id,colaborador.puesto_id,colaborador.centroc_cliente_id,colaborador.de_jornada_id,colaborador.politica_id,colaborador.grupo_nomina_id,colaborador.ba_tipo_baja_id,colaborador.tipo_compensacion_id,colaborador.sede_id,colaborador.de_tipo_contrato_id,colaborador.area_id,colaborador.persona_id," +
            "personaId.url_imagen AS personaIdurl_imagen,personaId.ci_puesto AS personaIdci_puesto, personaId.iba_num_hijos AS personaIdiba_num_hijos,personaId.ce_telefono AS personaIdce_telefono,personaId.ci_telefono AS personaIdci_telefono,personaId.ci_extension AS personaIdci_extension,personaId.curp AS personaIdcurp,personaId.rfc AS personaIdrfc,personaId.nombre AS personaIdnombre,personaId.apellido_pat AS personaIdapellido_pat,personaId.apellido_mat AS personaIdapellido_mat,personaId.email_corp AS personaIdemail_corp,personaId.genero AS personaIdgenero,personaId.nss AS personaIdnss,personaId.ce_nombre AS personaIdce_nombre,personaId.ce_e_mail AS personaIdce_e_mail,personaId.rl_url_firma AS personaIdrl_url_firma,personaId.ci_email_personal AS personaIdci_email_personal,personaId.ce_apellido_paterno AS personaIdce_apellido_paterno,personaId.ce_apellido_materno AS personaIdce_apellido_materno,personaId.iba_estado_civil AS personaIdiba_estado_civil,personaId.url_linkedin AS personaIdurl_linkedin,personaId.fecha_nace AS personaIdfecha_nace,personaId.fecha_alta AS personaIdfecha_alta,personaId.es_activo AS personaIdes_activo,personaId.tiene_curp AS personaIdtiene_curp,personaId.tiene_rfc AS personaIdtiene_rfc,personaId.tiene_nss AS personaIdtiene_nss,personaId.iba_tiene_hijos AS personaIdiba_tiene_hijos,personaId.invitar_empleado AS personaIdinvitar_empleado,personaId.iba_nacionalidad_id AS personaIdiba_nacionalidad_id,personaId.tipo_persona_id AS personaIdtipo_persona_id,personaId.tipo_representante_id AS personaIdtipo_representante_id,personaId.representante_legal_centroc_cliente_id AS personaIdrepresentante_legal_centroc_cliente_id,personaId.ce_parentesco_id AS personaIdce_parentesco_id,personaId.celular AS personaIdcelular, personaId.poder_notarial AS personaIdpoder_notarial, personaId.facultad_poder_id AS  personaIdfacultad_poder_id " +
            "FROM nco_contrato_colaborador colaborador " +
            "INNER JOIN (SELECT persona_id,MAX(fecha_inicio) fecha FROM nco_contrato_colaborador GROUP BY persona_id) colaborador_fecha " +
            "ON colaborador.fecha_inicio = colaborador_fecha.fecha AND colaborador.persona_id = colaborador_fecha.persona_id " +
            "INNER JOIN nco_persona personaId ON colaborador.persona_id=personaId.persona_id " +
            "AND colaborador.area_id = :areaId " +
            "ORDER BY colaborador.persona_id",
            nativeQuery = true)
    @Join(value = "personaId", alias = "personaId")
    List<NcoContratoColaborador> findByAreaIdAndEsActivo(Integer areaId);

    @Query(value = "SELECT colaborador.fecha_fin_ultimo_pago,colaborador.ppp_snm,colaborador.estatus_baja_id,colaborador.salario_diario_integrado,colaborador.ppp_monto_complementario,colaborador.ppp_sbm,colaborador.fecha_alta_imss,colaborador.jefe_inmediato_persona_id, colaborador.fecha_contrato,colaborador.salario_diario,colaborador.fecha_inicio,colaborador.fecha_fin,colaborador.de_fecha_antiguedad,colaborador.de_es_sindicalizado,colaborador.su_es_subcontratado,colaborador.su_porcentaje,colaborador.sueldo_bruto_mensual,colaborador.num_empleado,colaborador.sbc,colaborador.dias_vacaciones,colaborador.ba_fecha_para_calculo,colaborador.ba_ultimo_dia,colaborador.ba_notas,colaborador.es_activo,colaborador.de_tipo_jornada_id,colaborador.sueldo_neto_mensual,colaborador.su_subcontratista,colaborador.de_tipo_regimen_contratacion_id,colaborador.de_area_geografica_id,colaborador.de_c_estado,colaborador.metodo_pago_id,colaborador.ba_motivo_baja_id, colaborador.su_subcontratista_id,colaborador.puesto_id,colaborador.centroc_cliente_id,colaborador.de_jornada_id,colaborador.politica_id,colaborador.grupo_nomina_id,colaborador.ba_tipo_baja_id,colaborador.tipo_compensacion_id,colaborador.sede_id,colaborador.de_tipo_contrato_id,colaborador.area_id,colaborador.persona_id," +
            "personaId.url_imagen AS personaIdurl_imagen,personaId.ci_puesto AS personaIdci_puesto, personaId.iba_num_hijos AS personaIdiba_num_hijos,personaId.ce_telefono AS personaIdce_telefono,personaId.ci_telefono AS personaIdci_telefono,personaId.ci_extension AS personaIdci_extension,personaId.curp AS personaIdcurp,personaId.rfc AS personaIdrfc,personaId.nombre AS personaIdnombre,personaId.apellido_pat AS personaIdapellido_pat,personaId.apellido_mat AS personaIdapellido_mat,personaId.email_corp AS personaIdemail_corp,personaId.genero AS personaIdgenero,personaId.nss AS personaIdnss,personaId.ce_nombre AS personaIdce_nombre,personaId.ce_e_mail AS personaIdce_e_mail,personaId.rl_url_firma AS personaIdrl_url_firma,personaId.ci_email_personal AS personaIdci_email_personal,personaId.ce_apellido_paterno AS personaIdce_apellido_paterno,personaId.ce_apellido_materno AS personaIdce_apellido_materno,personaId.iba_estado_civil AS personaIdiba_estado_civil,personaId.url_linkedin AS personaIdurl_linkedin,personaId.fecha_nace AS personaIdfecha_nace,personaId.fecha_alta AS personaIdfecha_alta,personaId.es_activo AS personaIdes_activo,personaId.tiene_curp AS personaIdtiene_curp,personaId.tiene_rfc AS personaIdtiene_rfc,personaId.tiene_nss AS personaIdtiene_nss,personaId.iba_tiene_hijos AS personaIdiba_tiene_hijos,personaId.invitar_empleado AS personaIdinvitar_empleado,personaId.iba_nacionalidad_id AS personaIdiba_nacionalidad_id,personaId.tipo_persona_id AS personaIdtipo_persona_id,personaId.tipo_representante_id AS personaIdtipo_representante_id,personaId.representante_legal_centroc_cliente_id AS personaIdrepresentante_legal_centroc_cliente_id,personaId.ce_parentesco_id AS personaIdce_parentesco_id,personaId.celular AS personaIdcelular, personaId.poder_notarial AS personaIdpoder_notarial, personaId.facultad_poder_id AS  personaIdfacultad_poder_id " +
            "FROM nco_contrato_colaborador colaborador " +
            "INNER JOIN (SELECT persona_id,MAX(fecha_inicio) fecha FROM nco_contrato_colaborador GROUP BY persona_id) colaborador_fecha " +
            "ON colaborador.fecha_inicio = colaborador_fecha.fecha AND colaborador.persona_id = colaborador_fecha.persona_id " +
            "INNER JOIN nco_persona personaId ON colaborador.persona_id=personaId.persona_id " +
            "AND colaborador.grupo_nomina_id = :grupoNominaId " +
            "AND colaborador.es_activo = true " +
            "ORDER BY colaborador.persona_id",
            nativeQuery = true)
    @Join(value = "personaId", alias = "personaId")
    List<NcoContratoColaborador> findByGrupoNominaId(Integer grupoNominaId);

    @Query(value = "SELECT colaborador.fecha_fin_ultimo_pago,colaborador.ppp_snm,colaborador.estatus_baja_id,colaborador.salario_diario_integrado,colaborador.ppp_monto_complementario,colaborador.ppp_sbm,colaborador.fecha_alta_imss,colaborador.jefe_inmediato_persona_id, colaborador.fecha_contrato,colaborador.salario_diario,colaborador.fecha_inicio,colaborador.fecha_fin,colaborador.de_fecha_antiguedad,colaborador.de_es_sindicalizado,colaborador.su_es_subcontratado,colaborador.su_porcentaje,colaborador.sueldo_bruto_mensual,colaborador.num_empleado,colaborador.sbc,colaborador.dias_vacaciones,colaborador.ba_fecha_para_calculo,colaborador.ba_ultimo_dia,colaborador.ba_notas,colaborador.es_activo,colaborador.de_tipo_jornada_id,colaborador.sueldo_neto_mensual,colaborador.su_subcontratista,colaborador.de_tipo_regimen_contratacion_id,colaborador.de_area_geografica_id,colaborador.de_c_estado,colaborador.metodo_pago_id,colaborador.ba_motivo_baja_id, colaborador.su_subcontratista_id,colaborador.puesto_id,colaborador.centroc_cliente_id,colaborador.de_jornada_id,colaborador.politica_id,colaborador.grupo_nomina_id,colaborador.ba_tipo_baja_id,colaborador.tipo_compensacion_id,colaborador.sede_id,colaborador.de_tipo_contrato_id,colaborador.area_id,colaborador.persona_id," +
            "personaId.url_imagen AS personaIdurl_imagen,personaId.ci_puesto AS personaIdci_puesto, personaId.iba_num_hijos AS personaIdiba_num_hijos,personaId.ce_telefono AS personaIdce_telefono,personaId.ci_telefono AS personaIdci_telefono,personaId.ci_extension AS personaIdci_extension,personaId.curp AS personaIdcurp,personaId.rfc AS personaIdrfc,personaId.nombre AS personaIdnombre,personaId.apellido_pat AS personaIdapellido_pat,personaId.apellido_mat AS personaIdapellido_mat,personaId.email_corp AS personaIdemail_corp,personaId.genero AS personaIdgenero,personaId.nss AS personaIdnss,personaId.ce_nombre AS personaIdce_nombre,personaId.ce_e_mail AS personaIdce_e_mail,personaId.rl_url_firma AS personaIdrl_url_firma,personaId.ci_email_personal AS personaIdci_email_personal,personaId.ce_apellido_paterno AS personaIdce_apellido_paterno,personaId.ce_apellido_materno AS personaIdce_apellido_materno,personaId.iba_estado_civil AS personaIdiba_estado_civil,personaId.url_linkedin AS personaIdurl_linkedin,personaId.fecha_nace AS personaIdfecha_nace,personaId.fecha_alta AS personaIdfecha_alta,personaId.es_activo AS personaIdes_activo,personaId.tiene_curp AS personaIdtiene_curp,personaId.tiene_rfc AS personaIdtiene_rfc,personaId.tiene_nss AS personaIdtiene_nss,personaId.iba_tiene_hijos AS personaIdiba_tiene_hijos,personaId.invitar_empleado AS personaIdinvitar_empleado,personaId.iba_nacionalidad_id AS personaIdiba_nacionalidad_id,personaId.tipo_persona_id AS personaIdtipo_persona_id,personaId.tipo_representante_id AS personaIdtipo_representante_id,personaId.representante_legal_centroc_cliente_id AS personaIdrepresentante_legal_centroc_cliente_id,personaId.ce_parentesco_id AS personaIdce_parentesco_id,personaId.celular AS personaIdcelular, personaId.poder_notarial AS personaIdpoder_notarial, personaId.facultad_poder_id AS  personaIdfacultad_poder_id " +
            "FROM nco_contrato_colaborador colaborador " +
            "INNER JOIN (SELECT persona_id,MAX(fecha_inicio) fecha FROM nco_contrato_colaborador GROUP BY persona_id) colaborador_fecha " +
            "ON colaborador.fecha_inicio = colaborador_fecha.fecha AND colaborador.persona_id = colaborador_fecha.persona_id " +
            "INNER JOIN nco_persona personaId ON colaborador.persona_id=personaId.persona_id " +
            "AND colaborador.centroc_cliente_id = :centrocClienteId " +
            "AND colaborador.num_empleado = :numEmpleado " +
            "ORDER BY colaborador.persona_id",
            nativeQuery = true)
    @Join(value = "personaId", alias = "personaId")
    Optional<NcoContratoColaborador> findByCentrocClienteIdCentrocClienteIdAndNumEmpleado(Integer centrocClienteId, String numEmpleado);

    @Query(value = "SELECT colaborador.fecha_fin_ultimo_pago,colaborador.ppp_snm,colaborador.estatus_baja_id,colaborador.salario_diario_integrado,colaborador.ppp_monto_complementario,colaborador.ppp_sbm,colaborador.fecha_alta_imss,colaborador.jefe_inmediato_persona_id, colaborador.fecha_contrato,colaborador.salario_diario,colaborador.fecha_inicio,colaborador.fecha_fin,colaborador.de_fecha_antiguedad,colaborador.de_es_sindicalizado,colaborador.su_es_subcontratado,colaborador.su_porcentaje,colaborador.sueldo_bruto_mensual,colaborador.num_empleado,colaborador.sbc,colaborador.dias_vacaciones,colaborador.ba_fecha_para_calculo,colaborador.ba_ultimo_dia,colaborador.ba_notas,colaborador.es_activo,colaborador.de_tipo_jornada_id,colaborador.sueldo_neto_mensual,colaborador.su_subcontratista,colaborador.de_tipo_regimen_contratacion_id,colaborador.de_area_geografica_id,colaborador.de_c_estado,colaborador.metodo_pago_id,colaborador.ba_motivo_baja_id, colaborador.su_subcontratista_id,colaborador.puesto_id,colaborador.centroc_cliente_id,colaborador.de_jornada_id,colaborador.politica_id,colaborador.grupo_nomina_id,colaborador.ba_tipo_baja_id,colaborador.tipo_compensacion_id,colaborador.sede_id,colaborador.de_tipo_contrato_id,colaborador.area_id,colaborador.persona_id," +
            "personaId.url_imagen AS personaIdurl_imagen,personaId.ci_puesto AS personaIdci_puesto, personaId.iba_num_hijos AS personaIdiba_num_hijos,personaId.ce_telefono AS personaIdce_telefono,personaId.ci_telefono AS personaIdci_telefono,personaId.ci_extension AS personaIdci_extension,personaId.curp AS personaIdcurp,personaId.rfc AS personaIdrfc,personaId.nombre AS personaIdnombre,personaId.apellido_pat AS personaIdapellido_pat,personaId.apellido_mat AS personaIdapellido_mat,personaId.email_corp AS personaIdemail_corp,personaId.genero AS personaIdgenero,personaId.nss AS personaIdnss,personaId.ce_nombre AS personaIdce_nombre,personaId.ce_e_mail AS personaIdce_e_mail,personaId.rl_url_firma AS personaIdrl_url_firma,personaId.ci_email_personal AS personaIdci_email_personal,personaId.ce_apellido_paterno AS personaIdce_apellido_paterno,personaId.ce_apellido_materno AS personaIdce_apellido_materno,personaId.iba_estado_civil AS personaIdiba_estado_civil,personaId.url_linkedin AS personaIdurl_linkedin,personaId.fecha_nace AS personaIdfecha_nace,personaId.fecha_alta AS personaIdfecha_alta,personaId.es_activo AS personaIdes_activo,personaId.tiene_curp AS personaIdtiene_curp,personaId.tiene_rfc AS personaIdtiene_rfc,personaId.tiene_nss AS personaIdtiene_nss,personaId.iba_tiene_hijos AS personaIdiba_tiene_hijos,personaId.invitar_empleado AS personaIdinvitar_empleado,personaId.iba_nacionalidad_id AS personaIdiba_nacionalidad_id,personaId.tipo_persona_id AS personaIdtipo_persona_id,personaId.tipo_representante_id AS personaIdtipo_representante_id,personaId.representante_legal_centroc_cliente_id AS personaIdrepresentante_legal_centroc_cliente_id,personaId.ce_parentesco_id AS personaIdce_parentesco_id,personaId.celular AS personaIdcelular, personaId.poder_notarial AS personaIdpoder_notarial, personaId.facultad_poder_id AS  personaIdfacultad_poder_id " +
            "FROM nco_contrato_colaborador colaborador " +
            "INNER JOIN (SELECT persona_id,num_empleado,MAX(fecha_inicio) fecha FROM nco_contrato_colaborador GROUP BY persona_id,num_empleado) colaborador_fecha " +
            "ON colaborador.fecha_inicio = colaborador_fecha.fecha AND colaborador.persona_id = colaborador_fecha.persona_id " +
            "INNER JOIN nco_persona personaId ON colaborador.persona_id=personaId.persona_id " +
            "AND colaborador.centroc_cliente_id = :centrocClienteId " +
            "AND colaborador.num_empleado = :numEmpleado " +
            "AND personaId.nombre = :nombre " +
            "AND personaId.apellido_pat = :apellido " +
            "ORDER BY colaborador.persona_id",
            nativeQuery = true)
    @Join(value = "personaId", alias = "personaId")
    Optional<NcoContratoColaborador> findByCentrocClienteIdCentrocClienteIdAndNumEmpleadoAndNombreAndApellido(Integer centrocClienteId, String numEmpleado, String nombre, String apellido);

    boolean existsByFechaContratoAndPersonaIdPersonaIdAndCentrocClienteIdCentrocClienteId(Date fechaContrato, Integer personaId, Integer centrocClienteId);

    /** Query para formatos excel, busqueda por empresa*/
    @Query(value = "SELECT DISTINCT (np.*) FROM nco_contrato_colaborador ncc2 " +
            "INNER JOIN ncl_politica np ON (ncc2.politica_id = np.politica_id)" +
            "WHERE ncc2.centroc_cliente_id = :idEmpresa AND np.es_activo = true",
            nativeQuery = true)
    List<NclPolitica> findByEmpresaPolitica(Integer idEmpresa);

    @Query(value = "SELECT DISTINCT (nj.*) FROM nco_contrato_colaborador ncc2 " +
            "INNER JOIN ncl_jornada nj  ON (nj.jornada_id = ncc2.de_jornada_id)" +
            "WHERE ncc2.centroc_cliente_id = :idEmpresa AND nj.es_activo = true",
            nativeQuery = true)
    List<NclJornada> findByEmpresaJornada(Integer idEmpresa);

    @Query(value = "SELECT DISTINCT (ngn.*) FROM nco_contrato_colaborador ncc2 " +
            "INNER JOIN ncl_grupo_nomina ngn  ON (ngn.grupo_nomina_id = ncc2.grupo_nomina_id) " +
            "WHERE ncc2.centroc_cliente_id = :idEmpresa AND ngn.es_activo = true",
            nativeQuery = true)
    List<NclGrupoNomina> findByEmpresaGrupoNomina(Integer idEmpresa);

    @Query(value = "SELECT DISTINCT (ngn.*) FROM nco_contrato_colaborador ncc2 " +
            "INNER JOIN ncl_grupo_nomina ngn  ON (ngn.grupo_nomina_id = ncc2.grupo_nomina_id) " +
            "WHERE ncc2.centroc_cliente_id = :idEmpresa AND ngn.es_activo = true " +
            "and ngn.pago_complementario = true ",
            nativeQuery = true)
    List<NclGrupoNomina> findByEmpresaGrupoNominaPagoComplementario(Integer idEmpresa);

    @Query(value = "SELECT DISTINCT (na.*) FROM nco_contrato_colaborador ncc2 " +
            "INNER JOIN ncl_area na  ON (na.area_id = ncc2.area_id) " +
            "WHERE ncc2.centroc_cliente_id = :idEmpresa AND na.es_activo = true",
            nativeQuery = true)
    List<NclArea> findByEmpresaArea(Integer idEmpresa);


    @Query(value = "SELECT DISTINCT (np.*) FROM nco_contrato_colaborador ncc2 " +
            "INNER JOIN ncl_puesto np  ON (np.puesto_id = ncc2.puesto_id) " +
            "WHERE ncc2.centroc_cliente_id = :idEmpresa AND np.es_activo = true",
            nativeQuery = true)
    List<NclPuesto> findByEmpresaPuesto(Integer idEmpresa);

    @Query(value = " SELECT np.* FROM nco_contrato_colaborador ncc " +
            " INNER JOIN nco_persona np ON (ncc.persona_id = np.persona_id) " +
            " Inner JOIN (SELECT persona_id,MAX(fecha_inicio) fecha FROM nco_contrato_colaborador GROUP BY persona_id) colaborador_fecha " +
            " ON ncc.fecha_inicio = colaborador_fecha.fecha AND ncc.persona_id = colaborador_fecha.persona_id  " +
            " WHERE ncc.centroc_cliente_id = :idEmpresa ORDER BY np.persona_id", nativeQuery = true)
    List<NcoPersona> findByEmpresaEmpleado(Integer idEmpresa);

    @Query(value = "SELECT colaborador.fecha_fin_ultimo_pago,colaborador.ppp_snm,colaborador.estatus_baja_id,colaborador.salario_diario_integrado,colaborador.ppp_monto_complementario,colaborador.ppp_sbm,colaborador.fecha_alta_imss,colaborador.salario_diario_integrado, colaborador.jefe_inmediato_persona_id,colaborador.fecha_contrato,colaborador.salario_diario,colaborador.fecha_inicio,colaborador.fecha_fin,colaborador.de_fecha_antiguedad,colaborador.de_es_sindicalizado,colaborador.su_es_subcontratado,colaborador.su_porcentaje,colaborador.sueldo_bruto_mensual,colaborador.num_empleado,colaborador.sbc,colaborador.dias_vacaciones,colaborador.ba_fecha_para_calculo,colaborador.ba_ultimo_dia,colaborador.ba_notas,colaborador.es_activo,colaborador.de_tipo_jornada_id,colaborador.sueldo_neto_mensual,colaborador.su_subcontratista,colaborador.de_tipo_regimen_contratacion_id,colaborador.de_area_geografica_id,colaborador.de_c_estado,colaborador.metodo_pago_id,colaborador.ba_motivo_baja_id, colaborador.su_subcontratista_id,colaborador.puesto_id,colaborador.centroc_cliente_id,colaborador.de_jornada_id,colaborador.politica_id,colaborador.grupo_nomina_id,colaborador.ba_tipo_baja_id,colaborador.tipo_compensacion_id,colaborador.sede_id,colaborador.de_tipo_contrato_id,colaborador.area_id,colaborador.persona_id," +
            "puestoId.descripcion AS puestoIddescripcion,puestoId.nombre_corto AS puestoIdnombre_corto,puestoId.es_activo AS puestoIdes_activo,puestoId.fecha_alta AS puestoIdfecha_alta,puestoId.centroc_cliente_id AS puestoIdcentroc_cliente_id,puestoId.puesto_id_reporta AS puestoIdpuesto_id_reporta," +
            "centrocClienteId.curp AS centrocClienteIdcurp,centrocClienteId.rfc AS centrocClienteIdrfc,centrocClienteId.razon_social AS centrocClienteIdrazon_social,centrocClienteId.nombre AS centrocClienteIdnombre,centrocClienteId.fecha_constitucion AS centrocClienteIdfecha_constitucion,centrocClienteId.es_activo AS centrocClienteIdes_activo,centrocClienteId.centro_costos_centroc_cliente_id AS centrocClienteIdcentro_costos_centroc_cliente_id,centrocClienteId.cc_url_logo AS centrocClienteIdcc_url_logo,centrocClienteId.fecha_alta AS centrocClienteIdfecha_alta,centrocClienteId.em_c_regimenfiscal AS centrocClienteIdem_c_regimenfiscal,centrocClienteId.base_periodo_id AS centrocClienteIdbase_periodo_id,centrocClienteId.c_actividad_economica AS centrocClienteIdc_actividad_economica,centrocClienteId.certificado_sello_digital_id AS centrocClienteIdcertificado_sello_digital_id,centrocClienteId.multiempresa AS centrocClienteIdmultiempresa, centrocClienteId.pago_complementario as centrocClienteIdpago_complementario, " +
            "areaId.descripcion AS areaIddescripcion,areaId.nombre_corto AS areaIdnombre_corto,areaId.fecha_alta AS areaIdfecha_alta,areaId.es_activo AS areaIdes_activo,areaId.area_id_adscripcion AS areaIdarea_id_adscripcion,areaId.centroc_cliente_id AS areaIdcentroc_cliente_id," +
            "sedeId.descripcion AS sedeIddescripcion,sedeId.nombre_corto AS sedeIdnombre_corto,sedeId.es_activo AS sedeIdes_activo,sedeId.fecha_alta AS sedeIdfecha_alta,sedeId.centroc_cliente_id AS sedeIdcentroc_cliente_id," +
            "personaId.url_imagen AS personaIdurl_imagen, personaId.ci_puesto AS personaIdci_puesto, personaId.iba_num_hijos AS personaIdiba_num_hijos,personaId.ce_telefono AS personaIdce_telefono,personaId.ci_telefono AS personaIdci_telefono,personaId.ci_extension AS personaIdci_extension,personaId.curp AS personaIdcurp,personaId.rfc AS personaIdrfc,personaId.nombre AS personaIdnombre,personaId.apellido_pat AS personaIdapellido_pat,personaId.apellido_mat AS personaIdapellido_mat,personaId.email_corp AS personaIdemail_corp,personaId.genero AS personaIdgenero,personaId.nss AS personaIdnss,personaId.ce_nombre AS personaIdce_nombre,personaId.ce_e_mail AS personaIdce_e_mail,personaId.rl_url_firma AS personaIdrl_url_firma,personaId.ci_email_personal AS personaIdci_email_personal,personaId.ce_apellido_paterno AS personaIdce_apellido_paterno,personaId.ce_apellido_materno AS personaIdce_apellido_materno,personaId.iba_estado_civil AS personaIdiba_estado_civil,personaId.url_linkedin AS personaIdurl_linkedin,personaId.fecha_nace AS personaIdfecha_nace,personaId.fecha_alta AS personaIdfecha_alta,personaId.es_activo AS personaIdes_activo,personaId.tiene_curp AS personaIdtiene_curp,personaId.tiene_rfc AS personaIdtiene_rfc,personaId.tiene_nss AS personaIdtiene_nss,personaId.iba_tiene_hijos AS personaIdiba_tiene_hijos,personaId.invitar_empleado AS personaIdinvitar_empleado,personaId.iba_nacionalidad_id AS personaIdiba_nacionalidad_id,personaId.tipo_persona_id AS personaIdtipo_persona_id,personaId.tipo_representante_id AS personaIdtipo_representante_id,personaId.representante_legal_centroc_cliente_id AS personaIdrepresentante_legal_centroc_cliente_id,personaId.ce_parentesco_id AS personaIdce_parentesco_id,personaId.celular AS personaIdcelular, personaId.poder_notarial AS personaIdpoder_notarial, personaId.facultad_poder_id AS  personaIdfacultad_poder_id " +
            "FROM nco_contrato_colaborador colaborador " +
            "INNER JOIN (SELECT persona_id,MAX(fecha_inicio) fecha FROM nco_contrato_colaborador GROUP BY persona_id) colaborador_fecha " +
            "ON colaborador.fecha_inicio = colaborador_fecha.fecha AND colaborador.persona_id = colaborador_fecha.persona_id " +
            "INNER JOIN ncl_puesto puestoId ON colaborador.puesto_id=puestoId.puesto_id " +
            "INNER JOIN ncl_centroc_cliente centrocClienteId ON colaborador.centroc_cliente_id=centrocClienteId.centroc_cliente_id " +
            "INNER JOIN ncl_area areaId ON colaborador.area_id=areaId.area_id " +
            "LEFT JOIN ncl_sede sedeId ON colaborador.sede_id=sedeId.sede_id " +
            "INNER JOIN nco_persona personaId ON colaborador.persona_id = personaId.persona_id " +
            " WHERE colaborador.centroc_cliente_id = :idEmpresa " +
            " ORDER BY colaborador.persona_id", nativeQuery = true)
    @Join(value = "areaId", alias = "areaId")
    @Join(value = "puestoId", alias = "puestoId")
    @Join(value = "sedeId", alias = "sedeId")
    @Join(value = "centrocClienteId", alias = "centrocClienteId")
    @Join(value = "personaId", alias = "personaId")
    List<NcoContratoColaborador> findByEmpresa(Integer idEmpresa);


    @Query(value = "select concat(ROW_NUMBER() OVER(ORDER BY np.persona_id ASC),'|',np.rfc) as informacion   " +
            "from ncr_empleado_xnomina nex   " +
            "inner join nco_persona np on np.persona_id = nex.persona_id  " +
            "where nex.nomina_xperiodo_id =:nominaXperiodoId " +
            "order by np.persona_id ", nativeQuery = true)
    List<String> recuperaIdAndRfc(Integer nominaXperiodoId);

    boolean existsByGrupoNominaIdGrupoNominaId(Integer grupoNominaId);

    @Join(value = "politicaId", alias = "np")
    @Join(value = "politicaId.calculoAntiguedadId", alias = "ca")
    Optional<NcoContratoColaborador> findFirstByPersonaIdPersonaIdAndEsActivoOrderByFechaContratoDesc(Long id, Boolean esActivo);

    @Join(value = "politicaId", alias = "np")
    @Join(value = "politicaId.calculoAntiguedadId", alias = "ca")
    Optional<NcoContratoColaborador> findFirstByPersonaIdPersonaIdOrderByFechaContratoDesc(Long id);

    @Join(value = "tipoBajaId", alias = "tipoBajaId")
    @Join(value = "areaGeograficaId", alias = "areaGeograficaId")
    @Join(value = "tipoContratoId", alias = "tipoContratoId")
    @Join(value = "tipoCompensacionId", alias = "tipoCompensacionId")
    @Join(value = "grupoNominaId", alias = "grupoNominaId")
    @Join(value = "politicaId", alias = "politicaId")
    @Join(value = "estadoId", alias = "estadoId")
    @Join(value = "jornadaId", alias = "jornadaId")
    @Join(value = "tipoRegimenContratacionId", alias = "tipoRegimenContratacionId")
    @Join(value = "metodoPagoId", alias = "metodoPagoId")
    @Join(value = "areaId", alias = "areaId")
    @Join(value = "puestoId", alias = "puestoId")
    @Join(value = "sedeId", alias = "sedeId", type = Join.Type.LEFT)
    @Join(value = "centrocClienteId", alias = "centrocClienteId")
    @Join(value = "personaId", alias = "personaId")
    List<NcoContratoColaborador> findByCentrocClienteIdCentrocClienteIdAndTipoBajaIdTipoBajaIdInList(Integer centrocClienteId, List<Integer> tipoBajaId);

    @Query(value = "SELECT colaborador.fecha_fin_ultimo_pago,colaborador.ppp_snm,colaborador.estatus_baja_id,colaborador.salario_diario_integrado,colaborador.ppp_monto_complementario,colaborador.ppp_sbm,colaborador.fecha_alta_imss,colaborador.salario_diario_integrado, colaborador.jefe_inmediato_persona_id,colaborador.fecha_contrato,colaborador.salario_diario,colaborador.fecha_inicio,colaborador.fecha_fin,colaborador.de_fecha_antiguedad,colaborador.de_es_sindicalizado,colaborador.su_es_subcontratado,colaborador.su_porcentaje,colaborador.sueldo_bruto_mensual,colaborador.num_empleado,colaborador.sbc,colaborador.dias_vacaciones,colaborador.ba_fecha_para_calculo,colaborador.ba_ultimo_dia,colaborador.ba_notas,colaborador.es_activo,colaborador.de_tipo_jornada_id,colaborador.sueldo_neto_mensual,colaborador.su_subcontratista,colaborador.de_tipo_regimen_contratacion_id,colaborador.de_area_geografica_id,colaborador.de_c_estado,colaborador.metodo_pago_id,colaborador.ba_motivo_baja_id, colaborador.su_subcontratista_id,colaborador.puesto_id,colaborador.centroc_cliente_id,colaborador.de_jornada_id,colaborador.politica_id,colaborador.grupo_nomina_id,colaborador.ba_tipo_baja_id,colaborador.tipo_compensacion_id,colaborador.sede_id,colaborador.de_tipo_contrato_id,colaborador.area_id,colaborador.persona_id," +
            "puestoId.descripcion AS puestoIddescripcion,puestoId.nombre_corto AS puestoIdnombre_corto,puestoId.es_activo AS puestoIdes_activo,puestoId.fecha_alta AS puestoIdfecha_alta,puestoId.centroc_cliente_id AS puestoIdcentroc_cliente_id,puestoId.puesto_id_reporta AS puestoIdpuesto_id_reporta," +
            "centrocClienteId.curp AS centrocClienteIdcurp,centrocClienteId.rfc AS centrocClienteIdrfc,centrocClienteId.razon_social AS centrocClienteIdrazon_social,centrocClienteId.nombre AS centrocClienteIdnombre,centrocClienteId.fecha_constitucion AS centrocClienteIdfecha_constitucion,centrocClienteId.es_activo AS centrocClienteIdes_activo,centrocClienteId.centro_costos_centroc_cliente_id AS centrocClienteIdcentro_costos_centroc_cliente_id,centrocClienteId.cc_url_logo AS centrocClienteIdcc_url_logo,centrocClienteId.fecha_alta AS centrocClienteIdfecha_alta,centrocClienteId.em_c_regimenfiscal AS centrocClienteIdem_c_regimenfiscal,centrocClienteId.base_periodo_id AS centrocClienteIdbase_periodo_id,centrocClienteId.c_actividad_economica AS centrocClienteIdc_actividad_economica,centrocClienteId.certificado_sello_digital_id AS centrocClienteIdcertificado_sello_digital_id,centrocClienteId.multiempresa AS centrocClienteIdmultiempresa, " +
            "areaId.descripcion AS areaIddescripcion,areaId.nombre_corto AS areaIdnombre_corto,areaId.fecha_alta AS areaIdfecha_alta,areaId.es_activo AS areaIdes_activo,areaId.area_id_adscripcion AS areaIdarea_id_adscripcion,areaId.centroc_cliente_id AS areaIdcentroc_cliente_id," +
            "sedeId.descripcion AS sedeIddescripcion,sedeId.nombre_corto AS sedeIdnombre_corto,sedeId.es_activo AS sedeIdes_activo,sedeId.fecha_alta AS sedeIdfecha_alta,sedeId.centroc_cliente_id AS sedeIdcentroc_cliente_id," +
            "personaId.url_imagen AS personaIdurl_imagen, personaId.ci_puesto AS personaIdci_puesto, personaId.iba_num_hijos AS personaIdiba_num_hijos,personaId.ce_telefono AS personaIdce_telefono,personaId.ci_telefono AS personaIdci_telefono,personaId.ci_extension AS personaIdci_extension,personaId.curp AS personaIdcurp,personaId.rfc AS personaIdrfc,personaId.nombre AS personaIdnombre,personaId.apellido_pat AS personaIdapellido_pat,personaId.apellido_mat AS personaIdapellido_mat,personaId.email_corp AS personaIdemail_corp,personaId.genero AS personaIdgenero,personaId.nss AS personaIdnss,personaId.ce_nombre AS personaIdce_nombre,personaId.ce_e_mail AS personaIdce_e_mail,personaId.rl_url_firma AS personaIdrl_url_firma,personaId.ci_email_personal AS personaIdci_email_personal,personaId.ce_apellido_paterno AS personaIdce_apellido_paterno,personaId.ce_apellido_materno AS personaIdce_apellido_materno,personaId.iba_estado_civil AS personaIdiba_estado_civil,personaId.url_linkedin AS personaIdurl_linkedin,personaId.fecha_nace AS personaIdfecha_nace,personaId.fecha_alta AS personaIdfecha_alta,personaId.es_activo AS personaIdes_activo,personaId.tiene_curp AS personaIdtiene_curp,personaId.tiene_rfc AS personaIdtiene_rfc,personaId.tiene_nss AS personaIdtiene_nss,personaId.iba_tiene_hijos AS personaIdiba_tiene_hijos,personaId.invitar_empleado AS personaIdinvitar_empleado,personaId.iba_nacionalidad_id AS personaIdiba_nacionalidad_id,personaId.tipo_persona_id AS personaIdtipo_persona_id,personaId.tipo_representante_id AS personaIdtipo_representante_id,personaId.representante_legal_centroc_cliente_id AS personaIdrepresentante_legal_centroc_cliente_id,personaId.ce_parentesco_id AS personaIdce_parentesco_id,personaId.celular AS personaIdcelular, personaId.poder_notarial AS personaIdpoder_notarial, personaId.facultad_poder_id AS  personaIdfacultad_poder_id " +
            "FROM nco_contrato_colaborador colaborador " +
            "INNER JOIN (SELECT persona_id,MAX(fecha_inicio) fecha FROM nco_contrato_colaborador GROUP BY persona_id) colaborador_fecha " +
            "ON colaborador.fecha_inicio = colaborador_fecha.fecha AND colaborador.persona_id = colaborador_fecha.persona_id " +
            "INNER JOIN ncl_puesto puestoId ON colaborador.puesto_id=puestoId.puesto_id " +
            "INNER JOIN ncl_centroc_cliente centrocClienteId ON colaborador.centroc_cliente_id=centrocClienteId.centroc_cliente_id " +
            "INNER JOIN ncl_area areaId ON colaborador.area_id=areaId.area_id " +
            "LEFT JOIN ncl_sede sedeId ON colaborador.sede_id=sedeId.sede_id " +
            "INNER JOIN nco_persona personaId ON colaborador.persona_id = personaId.persona_id " +
            "WHERE colaborador.centroc_cliente_id = :centrocClienteId " +
            "AND colaborador.estatus_baja_id = :estatusBajaId ",
            nativeQuery = true)
    @Join(value = "areaId", alias = "areaId")
    @Join(value = "puestoId", alias = "puestoId")
    @Join(value = "sedeId", alias = "sedeId")
    @Join(value = "centrocClienteId", alias = "centrocClienteId")
    @Join(value = "personaId", alias = "personaId")
    List<NcoContratoColaborador> findByCentrocClienteIdCentrocClienteIdAndEstatusBajaId(Integer centrocClienteId, Integer estatusBajaId);

    @Query(value = "SELECT count(1) FROM nco_contrato_colaborador ncc " +
            "WHERE ncc.grupo_nomina_id = :grupoNominaId " +
            "AND ncc.centroc_cliente_id = :centroClienteId " +
            "AND :fechaInicioPeriodo between ncc.fecha_contrato and coalesce(fecha_fin, '2099-01-01') " +
            "AND ncc.es_activo = true", nativeQuery = true)
    Optional<Long> countByGrupoNominaIdCentroClienteIdEsActivo(Integer grupoNominaId, Integer centroClienteId, Date fechaInicioPeriodo);

    @Query(value = "SELECT colaborador.fecha_fin_ultimo_pago,colaborador.ppp_snm,colaborador.estatus_baja_id,colaborador.salario_diario_integrado,colaborador.ppp_monto_complementario,colaborador.ppp_sbm,colaborador.fecha_alta_imss,colaborador.salario_diario_integrado, colaborador.jefe_inmediato_persona_id,colaborador.fecha_contrato,colaborador.salario_diario,colaborador.fecha_inicio,colaborador.fecha_fin,colaborador.de_fecha_antiguedad,colaborador.de_es_sindicalizado,colaborador.su_es_subcontratado,colaborador.su_porcentaje,colaborador.sueldo_bruto_mensual,colaborador.num_empleado,colaborador.sbc,colaborador.dias_vacaciones,colaborador.ba_fecha_para_calculo,colaborador.ba_ultimo_dia,colaborador.ba_notas,colaborador.es_activo,colaborador.de_tipo_jornada_id,colaborador.sueldo_neto_mensual,colaborador.su_subcontratista,colaborador.de_tipo_regimen_contratacion_id,colaborador.de_area_geografica_id,colaborador.de_c_estado,colaborador.metodo_pago_id,colaborador.ba_motivo_baja_id, colaborador.su_subcontratista_id,colaborador.puesto_id,colaborador.centroc_cliente_id,colaborador.de_jornada_id,colaborador.politica_id,colaborador.grupo_nomina_id,colaborador.ba_tipo_baja_id,colaborador.tipo_compensacion_id,colaborador.sede_id,colaborador.de_tipo_contrato_id,colaborador.area_id,colaborador.persona_id," +
            "personaId.url_imagen AS personaIdurl_imagen, personaId.ci_puesto AS personaIdci_puesto, personaId.iba_num_hijos AS personaIdiba_num_hijos,personaId.ce_telefono AS personaIdce_telefono,personaId.ci_telefono AS personaIdci_telefono,personaId.ci_extension AS personaIdci_extension,personaId.curp AS personaIdcurp,personaId.rfc AS personaIdrfc,personaId.nombre AS personaIdnombre,personaId.apellido_pat AS personaIdapellido_pat,personaId.apellido_mat AS personaIdapellido_mat,personaId.email_corp AS personaIdemail_corp,personaId.genero AS personaIdgenero,personaId.nss AS personaIdnss,personaId.ce_nombre AS personaIdce_nombre,personaId.ce_e_mail AS personaIdce_e_mail,personaId.rl_url_firma AS personaIdrl_url_firma,personaId.ci_email_personal AS personaIdci_email_personal,personaId.ce_apellido_paterno AS personaIdce_apellido_paterno,personaId.ce_apellido_materno AS personaIdce_apellido_materno,personaId.iba_estado_civil AS personaIdiba_estado_civil,personaId.url_linkedin AS personaIdurl_linkedin,personaId.fecha_nace AS personaIdfecha_nace,personaId.fecha_alta AS personaIdfecha_alta,personaId.es_activo AS personaIdes_activo,personaId.tiene_curp AS personaIdtiene_curp,personaId.tiene_rfc AS personaIdtiene_rfc,personaId.tiene_nss AS personaIdtiene_nss,personaId.iba_tiene_hijos AS personaIdiba_tiene_hijos,personaId.invitar_empleado AS personaIdinvitar_empleado,personaId.iba_nacionalidad_id AS personaIdiba_nacionalidad_id,personaId.tipo_persona_id AS personaIdtipo_persona_id,personaId.tipo_representante_id AS personaIdtipo_representante_id,personaId.representante_legal_centroc_cliente_id AS personaIdrepresentante_legal_centroc_cliente_id,personaId.ce_parentesco_id AS personaIdce_parentesco_id,personaId.celular AS personaIdcelular, personaId.poder_notarial AS personaIdpoder_notarial, personaId.facultad_poder_id AS  personaIdfacultad_poder_id " +
            " FROM nco_contrato_colaborador colaborador " +
            "INNER JOIN nco_persona personaId ON colaborador.persona_id = personaId.persona_id " +
            "WHERE colaborador.centroc_cliente_id = :centroClienteId " +
            "AND colaborador.es_activo = true " +
            "AND NOT exists ( SELECT 1 FROM ncr_nomina_xperiodo nomina, ncr_empleado_xnomina empleado " +
            "                 WHERE nomina.nomina_xperiodo_id = empleado.nomina_xperiodo_id " +
            "                   AND nomina.tipo_nomina_id IN (2,3) " +
            "                   AND empleado.fecha_contrato_nogrupo = colaborador.fecha_contrato " +
            "                   AND empleado.persona_id = colaborador.persona_id " +
            "                   AND empleado.centroc_cliente_id = colaborador.centroc_cliente_id) " +
            "AND colaborador.fecha_inicio <= :fechaFin " +
            "AND coalesce(colaborador.fecha_fin, :fechaInicio ) >= :fechaInicio", nativeQuery = true)
    @Join(value = "personaId", alias = "personaId")
    List<NcoContratoColaborador> obtenColaboradoresNominaExtraordinaria(Integer centroClienteId, Date fechaInicio, Date fechaFin);

    @Query(value = "SELECT colaborador.fecha_fin_ultimo_pago,colaborador.ppp_snm,colaborador.estatus_baja_id,colaborador.salario_diario_integrado,colaborador.ppp_monto_complementario,colaborador.ppp_sbm,colaborador.fecha_alta_imss,colaborador.salario_diario_integrado, colaborador.jefe_inmediato_persona_id,colaborador.fecha_contrato,colaborador.salario_diario,colaborador.fecha_inicio,colaborador.fecha_fin,colaborador.de_fecha_antiguedad,colaborador.de_es_sindicalizado,colaborador.su_es_subcontratado,colaborador.su_porcentaje,colaborador.sueldo_bruto_mensual,colaborador.num_empleado,colaborador.sbc,colaborador.dias_vacaciones,colaborador.ba_fecha_para_calculo,colaborador.ba_ultimo_dia,colaborador.ba_notas,colaborador.es_activo,colaborador.de_tipo_jornada_id,colaborador.sueldo_neto_mensual,colaborador.su_subcontratista,colaborador.de_tipo_regimen_contratacion_id,colaborador.de_area_geografica_id,colaborador.de_c_estado,colaborador.metodo_pago_id,colaborador.ba_motivo_baja_id, colaborador.su_subcontratista_id,colaborador.puesto_id,colaborador.centroc_cliente_id,colaborador.de_jornada_id,colaborador.politica_id,colaborador.grupo_nomina_id,colaborador.ba_tipo_baja_id,colaborador.tipo_compensacion_id,colaborador.sede_id,colaborador.de_tipo_contrato_id,colaborador.area_id,colaborador.persona_id," +
            "personaId.url_imagen AS personaIdurl_imagen, personaId.ci_puesto AS personaIdci_puesto, personaId.iba_num_hijos AS personaIdiba_num_hijos,personaId.ce_telefono AS personaIdce_telefono,personaId.ci_telefono AS personaIdci_telefono,personaId.ci_extension AS personaIdci_extension,personaId.curp AS personaIdcurp,personaId.rfc AS personaIdrfc,personaId.nombre AS personaIdnombre,personaId.apellido_pat AS personaIdapellido_pat,personaId.apellido_mat AS personaIdapellido_mat,personaId.email_corp AS personaIdemail_corp,personaId.genero AS personaIdgenero,personaId.nss AS personaIdnss,personaId.ce_nombre AS personaIdce_nombre,personaId.ce_e_mail AS personaIdce_e_mail,personaId.rl_url_firma AS personaIdrl_url_firma,personaId.ci_email_personal AS personaIdci_email_personal,personaId.ce_apellido_paterno AS personaIdce_apellido_paterno,personaId.ce_apellido_materno AS personaIdce_apellido_materno,personaId.iba_estado_civil AS personaIdiba_estado_civil,personaId.url_linkedin AS personaIdurl_linkedin,personaId.fecha_nace AS personaIdfecha_nace,personaId.fecha_alta AS personaIdfecha_alta,personaId.es_activo AS personaIdes_activo,personaId.tiene_curp AS personaIdtiene_curp,personaId.tiene_rfc AS personaIdtiene_rfc,personaId.tiene_nss AS personaIdtiene_nss,personaId.iba_tiene_hijos AS personaIdiba_tiene_hijos,personaId.invitar_empleado AS personaIdinvitar_empleado,personaId.iba_nacionalidad_id AS personaIdiba_nacionalidad_id,personaId.tipo_persona_id AS personaIdtipo_persona_id,personaId.tipo_representante_id AS personaIdtipo_representante_id,personaId.representante_legal_centroc_cliente_id AS personaIdrepresentante_legal_centroc_cliente_id,personaId.ce_parentesco_id AS personaIdce_parentesco_id,personaId.celular AS personaIdcelular, personaId.poder_notarial AS personaIdpoder_notarial, personaId.facultad_poder_id AS  personaIdfacultad_poder_id " +
            " FROM nco_contrato_colaborador colaborador " +
            "INNER JOIN (SELECT persona_id,MAX(fecha_inicio) fecha FROM nco_contrato_colaborador GROUP BY persona_id) colaborador_fecha " +
            "ON colaborador.fecha_inicio = colaborador_fecha.fecha AND colaborador.persona_id = colaborador_fecha.persona_id " +
            "INNER JOIN nco_persona personaId ON colaborador.persona_id = personaId.persona_id " +
            "WHERE colaborador.centroc_cliente_id = :centroClienteId " +
            "AND colaborador.es_activo = false " +
            "AND NOT exists ( SELECT 1 FROM ncr_nomina_xperiodo nomina, ncr_empleado_xnomina empleado " +
            "                 WHERE nomina.nomina_xperiodo_id = empleado.nomina_xperiodo_id " +
            "                   AND nomina.tipo_nomina_id = 3 " +
            "                   AND empleado.fecha_contrato_nogrupo = colaborador.fecha_contrato " +
            "                   AND empleado.persona_id = colaborador.persona_id " +
            "                   AND empleado.centroc_cliente_id = colaborador.centroc_cliente_id) " +
            "AND colaborador.estatus_baja_id = 1 ", nativeQuery = true)
    @Join(value = "personaId", alias = "personaId")
    List<NcoContratoColaborador> obtenColaboradoresNominaFiniquito(Integer centroClienteId);

    @Query(value = "SELECT colaborador.fecha_fin_ultimo_pago,colaborador.ppp_snm,colaborador.estatus_baja_id,colaborador.salario_diario_integrado,colaborador.ppp_monto_complementario,colaborador.ppp_sbm,colaborador.fecha_alta_imss,colaborador.jefe_inmediato_persona_id,colaborador.fecha_contrato,colaborador.salario_diario,colaborador.fecha_inicio,colaborador.fecha_fin,colaborador.de_fecha_antiguedad,colaborador.de_es_sindicalizado,colaborador.su_es_subcontratado,colaborador.su_porcentaje,colaborador.sueldo_bruto_mensual,colaborador.num_empleado,colaborador.sbc,colaborador.dias_vacaciones,colaborador.ba_fecha_para_calculo,colaborador.ba_ultimo_dia,colaborador.ba_notas,colaborador.es_activo,colaborador.de_tipo_jornada_id,colaborador.sueldo_neto_mensual,colaborador.su_subcontratista,colaborador.de_tipo_regimen_contratacion_id,colaborador.de_area_geografica_id,colaborador.de_c_estado,colaborador.metodo_pago_id,colaborador.ba_motivo_baja_id, colaborador.su_subcontratista_id,colaborador.puesto_id,colaborador.centroc_cliente_id,colaborador.de_jornada_id,colaborador.politica_id,colaborador.grupo_nomina_id,colaborador.ba_tipo_baja_id,colaborador.tipo_compensacion_id,colaborador.sede_id,colaborador.de_tipo_contrato_id,colaborador.area_id,colaborador.persona_id," +
            "puestoId.descripcion AS puestoIddescripcion,puestoId.nombre_corto AS puestoIdnombre_corto,puestoId.es_activo AS puestoIdes_activo,puestoId.fecha_alta AS puestoIdfecha_alta,puestoId.centroc_cliente_id AS puestoIdcentroc_cliente_id,puestoId.puesto_id_reporta AS puestoIdpuesto_id_reporta," +
            "centrocClienteId.curp AS centrocClienteIdcurp,centrocClienteId.rfc AS centrocClienteIdrfc,centrocClienteId.razon_social AS centrocClienteIdrazon_social,centrocClienteId.nombre AS centrocClienteIdnombre,centrocClienteId.fecha_constitucion AS centrocClienteIdfecha_constitucion,centrocClienteId.es_activo AS centrocClienteIdes_activo,centrocClienteId.centro_costos_centroc_cliente_id AS centrocClienteIdcentro_costos_centroc_cliente_id,centrocClienteId.cc_url_logo AS centrocClienteIdcc_url_logo,centrocClienteId.fecha_alta AS centrocClienteIdfecha_alta,centrocClienteId.em_c_regimenfiscal AS centrocClienteIdem_c_regimenfiscal,centrocClienteId.base_periodo_id AS centrocClienteIdbase_periodo_id,centrocClienteId.c_actividad_economica AS centrocClienteIdc_actividad_economica,centrocClienteId.certificado_sello_digital_id AS centrocClienteIdcertificado_sello_digital_id,centrocClienteId.multiempresa AS centrocClienteIdmultiempresa, " +
            "areaId.descripcion AS areaIddescripcion,areaId.nombre_corto AS areaIdnombre_corto,areaId.fecha_alta AS areaIdfecha_alta,areaId.es_activo AS areaIdes_activo,areaId.area_id_adscripcion AS areaIdarea_id_adscripcion,areaId.centroc_cliente_id AS areaIdcentroc_cliente_id," +
            "personaId.url_imagen AS personaIdurl_imagen,personaId.ci_puesto AS personaIdci_puesto, personaId.iba_num_hijos AS personaIdiba_num_hijos,personaId.ce_telefono AS personaIdce_telefono,personaId.ci_telefono AS personaIdci_telefono,personaId.ci_extension AS personaIdci_extension,personaId.curp AS personaIdcurp,personaId.rfc AS personaIdrfc,personaId.nombre AS personaIdnombre,personaId.apellido_pat AS personaIdapellido_pat,personaId.apellido_mat AS personaIdapellido_mat,personaId.email_corp AS personaIdemail_corp,personaId.genero AS personaIdgenero,personaId.nss AS personaIdnss,personaId.ce_nombre AS personaIdce_nombre,personaId.ce_e_mail AS personaIdce_e_mail,personaId.rl_url_firma AS personaIdrl_url_firma,personaId.ci_email_personal AS personaIdci_email_personal,personaId.ce_apellido_paterno AS personaIdce_apellido_paterno,personaId.ce_apellido_materno AS personaIdce_apellido_materno,personaId.iba_estado_civil AS personaIdiba_estado_civil,personaId.url_linkedin AS personaIdurl_linkedin,personaId.fecha_nace AS personaIdfecha_nace,personaId.fecha_alta AS personaIdfecha_alta,personaId.es_activo AS personaIdes_activo,personaId.tiene_curp AS personaIdtiene_curp,personaId.tiene_rfc AS personaIdtiene_rfc,personaId.tiene_nss AS personaIdtiene_nss,personaId.iba_tiene_hijos AS personaIdiba_tiene_hijos,personaId.invitar_empleado AS personaIdinvitar_empleado,personaId.iba_nacionalidad_id AS personaIdiba_nacionalidad_id,personaId.tipo_persona_id AS personaIdtipo_persona_id,personaId.tipo_representante_id AS personaIdtipo_representante_id,personaId.representante_legal_centroc_cliente_id AS personaIdrepresentante_legal_centroc_cliente_id,personaId.ce_parentesco_id AS personaIdce_parentesco_id,personaId.celular AS personaIdcelular,personaId.poder_notarial AS personaIdpoder_notarial, personaId.facultad_poder_id AS  personaIdfacultad_poder_id, " +
            "metodoId.descripcion AS metodoPagoIddescripcion,metodoId.nombre_corto AS metodoPagoIdnombre_corto,metodoId.fecha_alta AS metodoPagoIdfecha_alta,metodoId.es_activo AS metodoPagoIdes_activo, " +
            "tipoRegimenContratacionId.descripcion AS tipoRegimenContratacionIddescripcion,tipoRegimenContratacionId.fecha_inicio AS tipoRegimenContratacionIdfecha_inicio,tipoRegimenContratacionId.fecha_fin AS tipoRegimenContratacionIdfecha_fin,tipoRegimenContratacionId.es_activo AS tipoRegimenContratacionIdes_activo, " +
            "jornadaId.tipo_jornada_id AS jornadaIdtipo_jornada_id,jornadaId.nombre AS jornadaIdnombre,jornadaId.mismo_horario AS jornadaIdmismo_horario,jornadaId.horario_comida AS jornadaIdhorario_comida,jornadaId.incidir_asistencias AS jornadaIdincidir_asistencias,jornadaId.hora_entrada AS jornadaIdhora_entrada,jornadaId.hora_inicio_comida AS jornadaIdhora_inicio_comida,jornadaId.hora_fin_comida AS jornadaIdhora_fin_comida,jornadaId.hora_salida AS jornadaIdhora_salida,jornadaId.es_activo AS jornadaIdes_activo,jornadaId.centroc_cliente_id AS jornadaIdcentroc_cliente_id,jornadaId.an_minutos_tolerancia AS jornadaIdan_minutos_tolerancia,jornadaId.an_hay_tolerancia AS jornadaIdan_hay_tolerancia,jornadaId.registro_prima_dominical_auto AS jornadaIdregistro_prima_dominical_auto,jornadaId.registro_descanso_laboral_auto AS jornadaIdregistro_descanso_laboral_auto,jornadaId.an_permite_justificar_retardo AS jornadaIdan_permite_justificar_retardo,jornadaId.solo_un_registro_dia AS jornadaIdsolo_un_registro_dia,jornadaId.para_dias_parcialmente_laborados AS jornadaIdpara_dias_parcialmente_laborados,jornadaId.he_solicitud_horas_extra AS jornadaIdhe_solicitud_horas_extra,jornadaId.he_minutos AS jornadaIdhe_minutos,jornadaId.suma_horas_jornada_id AS jornadaIdsuma_horas_jornada_id, " +
            "estadoId.clave_estado AS estadoIdclave_estado, estadoId.es_activo AS estadoIdes_activo,estadoId.fecha_alta AS estadoIdfecha_alta,estadoId.c_estado AS estadoIdc_estado,estadoId.d_estado AS estadoIdd_estado, " +
            "politicaId.calculo_antiguedadx_id AS politicaIdcalculo_antiguedadx_id, politicaId.nombre AS politicaIdnombre,politicaId.es_activo AS politicaIdes_activo,politicaId.nombre_corto AS politicaIdnombre_corto, politicaId.dias_economicos AS politicaIddias_economicos, politicaId.prima_aniversario AS politicaIdprima_aniversario, politicaId.descuenta_faltas AS politicaIddescuenta_faltas, politicaId.descuenta_incapacidades AS politicaIddescuenta_incapacidades, politicaId.costo_vales_restaurante AS politicaIdcosto_vales_restaurante, politicaId.descuento_prop_7o_dia AS politicaIddescuento_prop_7o_dia,politicaId.es_activo AS politicaIdes_activo, politicaId.centroc_cliente_id AS politicaIdcentroc_cliente_id, politicaId.es_estandar AS politicaIdes_estandar, " +
            "grupoNominaId.pago_complementario AS grupoNominaIdpago_complementario, grupoNominaId.nombre AS grupoNominaIdnombre,grupoNominaId.nombre_corto AS grupoNominaIdnombre_corto,grupoNominaId.esquema_pago_id AS grupoNominaIdesquema_pago_id,grupoNominaId.centroc_cliente_id AS grupoNominaIdcentroc_cliente_id,grupoNominaId.moneda_id AS grupoNominaIdmoneda_id,grupoNominaId.periodicidad_pago_id AS grupoNominaIdperiodicidad_pago_id,grupoNominaId.isr_aguinaldo_reglamento AS grupoNominaIdisr_aguinaldo_reglamento,grupoNominaId.es_automatica AS grupoNominaIdes_automatica,grupoNominaId.es_activo AS grupoNominaIdes_activo,grupoNominaId.es_predeterminado AS grupoNominaIdes_predeterminado,grupoNominaId.ajuste_mensual_isr AS grupoNominaIdajuste_mensual_isr,grupoNominaId.base_periodo_id AS grupoNominaIdbase_periodo_id,grupoNominaId.periodo_aguinaldo_id AS grupoNominaIdperiodo_aguinaldo_id,grupoNominaId.manera_calcular_subsidio AS grupoNominaIdmanera_calcular_subsidio,grupoNominaId.ajustar_base_gravable_faltantes AS grupoNominaIdajustar_base_gravable_faltantes,grupoNominaId.cuenta_banco_id AS grupoNominaIdcuenta_banco_id, " +
            "tipoCompensacionId.descripcion AS tipoCompensacionIddescripcion,tipoCompensacionId.nombre_corto AS tipoCompensacionIdnombre_corto,tipoCompensacionId.es_activo AS tipoCompensacionIdes_activo,tipoCompensacionId.fecha_alta AS tipoCompensacionIdfecha_alta " +
            "FROM nco_contrato_colaborador colaborador " +
            "INNER JOIN (SELECT persona_id,MAX(fecha_inicio) fecha FROM nco_contrato_colaborador GROUP BY persona_id) colaborador_fecha " +
            "ON colaborador.fecha_inicio = colaborador_fecha.fecha AND colaborador.persona_id = colaborador_fecha.persona_id " +
            "INNER JOIN ncl_puesto puestoId ON colaborador.puesto_id=puestoId.puesto_id " +
            "INNER JOIN ncl_centroc_cliente centrocClienteId ON colaborador.centroc_cliente_id=centrocClienteId.centroc_cliente_id " +
            "INNER JOIN ncl_area areaId ON colaborador.area_id=areaId.area_id " +
            "INNER JOIN nco_persona personaId ON colaborador.persona_id=personaId.persona_id " +
            "INNER JOIN cat_metodo_pago metodoId on colaborador.metodo_pago_id = metodoId.metodo_pago_id " +
            "INNER JOIN cs_tipo_regimen_contratacion tipoRegimenContratacionId on colaborador.de_tipo_regimen_contratacion_id = tipoRegimenContratacionId.tipo_regimen_contratacion_id " +
            "INNER JOIN ncl_jornada jornadaId on colaborador.de_jornada_id = jornadaId.jornada_id " +
            "INNER JOIN cat_estado estadoId on colaborador.de_c_estado = estadoId.c_estado " +
            "INNER JOIN ncl_politica politicaId on colaborador.politica_id = politicaId.politica_id " +
            "INNER JOIN ncl_grupo_nomina grupoNominaId on colaborador.grupo_nomina_id = grupoNominaId.grupo_nomina_id " +
            "INNER JOIN cat_tipo_compensacion tipoCompensacionId on colaborador.tipo_compensacion_id = tipoCompensacionId.tipo_compensacion_id " +
            "AND colaborador.centroc_cliente_id = :centrocClienteId " +
            "AND colaborador.es_activo = true  " +
            "AND colaborador.grupo_nomina_id = :grupoNominaId " +
            "ORDER BY colaborador.persona_id",
            nativeQuery = true)
    @Join(value = "tipoCompensacionId", alias = "tipoCompensacionId")
    @Join(value = "grupoNominaId", alias = "grupoNominaId")
    @Join(value = "politicaId", alias = "politicaId")
    @Join(value = "estadoId", alias = "estadoId")
    @Join(value = "jornadaId", alias = "jornadaId")
    @Join(value = "tipoRegimenContratacionId", alias = "tipoRegimenContratacionId")
    @Join(value = "metodoPagoId", alias = "metodoPagoId")
    @Join(value = "areaId", alias = "areaId")
    @Join(value = "puestoId", alias = "puestoId")
    @Join(value = "centrocClienteId", alias = "centrocClienteId")
    @Join(value = "personaId", alias = "personaId")
    List<NcoContratoColaborador> findByCentrocClienteIdCentrocClienteIdAndGrupoNominaIdGrupoNominaId(Integer centrocClienteId, Integer grupoNominaId, Date fechaPeriodo);

    @Query(value = "SELECT COUNT(*) FROM (\n" +
            "    SELECT persona_id FROM nco_contrato_colaborador colaborador\n" +
            "    WHERE colaborador.centroc_cliente_id = :centrocClienteId\n" +
            "      AND colaborador.es_activo = true\n" +
            "      AND colaborador.grupo_nomina_id = :grupoNominaId\n" +
            "      AND :fechaPeriodo between colaborador.fecha_contrato and coalesce(colaborador.fecha_fin, :fechaPeriodo)\n" +
            "    UNION\n" +
            "    SELECT persona_id FROM nco_contrato_colaborador colaborador\n" +
            "    WHERE colaborador.centroc_cliente_id = :centrocClienteId\n" +
            "      AND colaborador.es_activo = true\n" +
            "      AND colaborador.grupo_nomina_id = :grupoNominaId\n" +
            "      AND :fechaFinPeriodo between colaborador.fecha_contrato and coalesce(colaborador.fecha_fin, :fechaFinPeriodo)\n" +
            ") AS x",nativeQuery = true)
    Long countCentrocClienteIdCentrocClienteIdAndGrupoNominaIdGrupoNominaIdAndFechaPeriodo(Integer centrocClienteId, Integer grupoNominaId, Date fechaPeriodo, Date fechaFinPeriodo);

    @Query(value = "SELECT colaborador.fecha_fin_ultimo_pago,colaborador.ppp_snm,colaborador.estatus_baja_id,colaborador.salario_diario_integrado,colaborador.ppp_monto_complementario,colaborador.ppp_sbm,colaborador.fecha_alta_imss,colaborador.jefe_inmediato_persona_id,colaborador.fecha_contrato,colaborador.salario_diario,colaborador.fecha_inicio,colaborador.fecha_fin,colaborador.de_fecha_antiguedad,colaborador.de_es_sindicalizado,colaborador.su_es_subcontratado,colaborador.su_porcentaje,colaborador.sueldo_bruto_mensual,colaborador.num_empleado,colaborador.sbc,colaborador.dias_vacaciones,colaborador.ba_fecha_para_calculo,colaborador.ba_ultimo_dia,colaborador.ba_notas,colaborador.es_activo,colaborador.de_tipo_jornada_id,colaborador.sueldo_neto_mensual,colaborador.su_subcontratista,colaborador.de_tipo_regimen_contratacion_id,colaborador.de_area_geografica_id,colaborador.de_c_estado,colaborador.metodo_pago_id,colaborador.ba_motivo_baja_id, colaborador.su_subcontratista_id,colaborador.puesto_id,colaborador.centroc_cliente_id,colaborador.de_jornada_id,colaborador.politica_id,colaborador.grupo_nomina_id,colaborador.ba_tipo_baja_id,colaborador.tipo_compensacion_id,colaborador.sede_id,colaborador.de_tipo_contrato_id,colaborador.area_id,colaborador.persona_id," +
            "puestoId.descripcion AS puestoIddescripcion,puestoId.nombre_corto AS puestoIdnombre_corto,puestoId.es_activo AS puestoIdes_activo,puestoId.fecha_alta AS puestoIdfecha_alta,puestoId.centroc_cliente_id AS puestoIdcentroc_cliente_id,puestoId.puesto_id_reporta AS puestoIdpuesto_id_reporta," +
            "centrocClienteId.curp AS centrocClienteIdcurp,centrocClienteId.rfc AS centrocClienteIdrfc,centrocClienteId.razon_social AS centrocClienteIdrazon_social,centrocClienteId.nombre AS centrocClienteIdnombre,centrocClienteId.fecha_constitucion AS centrocClienteIdfecha_constitucion,centrocClienteId.es_activo AS centrocClienteIdes_activo,centrocClienteId.centro_costos_centroc_cliente_id AS centrocClienteIdcentro_costos_centroc_cliente_id,centrocClienteId.cc_url_logo AS centrocClienteIdcc_url_logo,centrocClienteId.fecha_alta AS centrocClienteIdfecha_alta,centrocClienteId.em_c_regimenfiscal AS centrocClienteIdem_c_regimenfiscal,centrocClienteId.base_periodo_id AS centrocClienteIdbase_periodo_id,centrocClienteId.c_actividad_economica AS centrocClienteIdc_actividad_economica,centrocClienteId.certificado_sello_digital_id AS centrocClienteIdcertificado_sello_digital_id,centrocClienteId.multiempresa AS centrocClienteIdmultiempresa, " +
            "areaId.descripcion AS areaIddescripcion,areaId.nombre_corto AS areaIdnombre_corto,areaId.fecha_alta AS areaIdfecha_alta,areaId.es_activo AS areaIdes_activo,areaId.area_id_adscripcion AS areaIdarea_id_adscripcion,areaId.centroc_cliente_id AS areaIdcentroc_cliente_id," +
            "personaId.url_imagen AS personaIdurl_imagen,personaId.ci_puesto AS personaIdci_puesto, personaId.iba_num_hijos AS personaIdiba_num_hijos,personaId.ce_telefono AS personaIdce_telefono,personaId.ci_telefono AS personaIdci_telefono,personaId.ci_extension AS personaIdci_extension,personaId.curp AS personaIdcurp,personaId.rfc AS personaIdrfc,personaId.nombre AS personaIdnombre,personaId.apellido_pat AS personaIdapellido_pat,personaId.apellido_mat AS personaIdapellido_mat,personaId.email_corp AS personaIdemail_corp,personaId.genero AS personaIdgenero,personaId.nss AS personaIdnss,personaId.ce_nombre AS personaIdce_nombre,personaId.ce_e_mail AS personaIdce_e_mail,personaId.rl_url_firma AS personaIdrl_url_firma,personaId.ci_email_personal AS personaIdci_email_personal,personaId.ce_apellido_paterno AS personaIdce_apellido_paterno,personaId.ce_apellido_materno AS personaIdce_apellido_materno,personaId.iba_estado_civil AS personaIdiba_estado_civil,personaId.url_linkedin AS personaIdurl_linkedin,personaId.fecha_nace AS personaIdfecha_nace,personaId.fecha_alta AS personaIdfecha_alta,personaId.es_activo AS personaIdes_activo,personaId.tiene_curp AS personaIdtiene_curp,personaId.tiene_rfc AS personaIdtiene_rfc,personaId.tiene_nss AS personaIdtiene_nss,personaId.iba_tiene_hijos AS personaIdiba_tiene_hijos,personaId.invitar_empleado AS personaIdinvitar_empleado,personaId.iba_nacionalidad_id AS personaIdiba_nacionalidad_id,personaId.tipo_persona_id AS personaIdtipo_persona_id,personaId.tipo_representante_id AS personaIdtipo_representante_id,personaId.representante_legal_centroc_cliente_id AS personaIdrepresentante_legal_centroc_cliente_id,personaId.ce_parentesco_id AS personaIdce_parentesco_id,personaId.celular AS personaIdcelular,personaId.poder_notarial AS personaIdpoder_notarial, personaId.facultad_poder_id AS  personaIdfacultad_poder_id, " +
            "metodoId.descripcion AS metodoPagoIddescripcion,metodoId.nombre_corto AS metodoPagoIdnombre_corto,metodoId.fecha_alta AS metodoPagoIdfecha_alta,metodoId.es_activo AS metodoPagoIdes_activo, " +
            "tipoRegimenContratacionId.descripcion AS tipoRegimenContratacionIddescripcion,tipoRegimenContratacionId.fecha_inicio AS tipoRegimenContratacionIdfecha_inicio,tipoRegimenContratacionId.fecha_fin AS tipoRegimenContratacionIdfecha_fin,tipoRegimenContratacionId.es_activo AS tipoRegimenContratacionIdes_activo, " +
            "jornadaId.tipo_jornada_id AS jornadaIdtipo_jornada_id,jornadaId.nombre AS jornadaIdnombre,jornadaId.mismo_horario AS jornadaIdmismo_horario,jornadaId.horario_comida AS jornadaIdhorario_comida,jornadaId.incidir_asistencias AS jornadaIdincidir_asistencias,jornadaId.hora_entrada AS jornadaIdhora_entrada,jornadaId.hora_inicio_comida AS jornadaIdhora_inicio_comida,jornadaId.hora_fin_comida AS jornadaIdhora_fin_comida,jornadaId.hora_salida AS jornadaIdhora_salida,jornadaId.es_activo AS jornadaIdes_activo,jornadaId.centroc_cliente_id AS jornadaIdcentroc_cliente_id,jornadaId.an_minutos_tolerancia AS jornadaIdan_minutos_tolerancia,jornadaId.an_hay_tolerancia AS jornadaIdan_hay_tolerancia,jornadaId.registro_prima_dominical_auto AS jornadaIdregistro_prima_dominical_auto,jornadaId.registro_descanso_laboral_auto AS jornadaIdregistro_descanso_laboral_auto,jornadaId.an_permite_justificar_retardo AS jornadaIdan_permite_justificar_retardo,jornadaId.solo_un_registro_dia AS jornadaIdsolo_un_registro_dia,jornadaId.para_dias_parcialmente_laborados AS jornadaIdpara_dias_parcialmente_laborados,jornadaId.he_solicitud_horas_extra AS jornadaIdhe_solicitud_horas_extra,jornadaId.he_minutos AS jornadaIdhe_minutos,jornadaId.suma_horas_jornada_id AS jornadaIdsuma_horas_jornada_id, " +
            "estadoId.clave_estado AS estadoIdclave_estado, estadoId.es_activo AS estadoIdes_activo,estadoId.fecha_alta AS estadoIdfecha_alta,estadoId.c_estado AS estadoIdc_estado,estadoId.d_estado AS estadoIdd_estado, " +
            "politicaId.calculo_antiguedadx_id AS politicaIdcalculo_antiguedadx_id, politicaId.nombre AS politicaIdnombre,politicaId.es_activo AS politicaIdes_activo,politicaId.nombre_corto AS politicaIdnombre_corto, politicaId.dias_economicos AS politicaIddias_economicos, politicaId.prima_aniversario AS politicaIdprima_aniversario, politicaId.descuenta_faltas AS politicaIddescuenta_faltas, politicaId.descuenta_incapacidades AS politicaIddescuenta_incapacidades, politicaId.costo_vales_restaurante AS politicaIdcosto_vales_restaurante, politicaId.descuento_prop_7o_dia AS politicaIddescuento_prop_7o_dia,politicaId.es_activo AS politicaIdes_activo, politicaId.centroc_cliente_id AS politicaIdcentroc_cliente_id, politicaId.es_estandar AS politicaIdes_estandar, " +
            "grupoNominaId.pago_complementario AS grupoNominaIdpago_complementario, grupoNominaId.nombre AS grupoNominaIdnombre,grupoNominaId.nombre_corto AS grupoNominaIdnombre_corto,grupoNominaId.esquema_pago_id AS grupoNominaIdesquema_pago_id,grupoNominaId.centroc_cliente_id AS grupoNominaIdcentroc_cliente_id,grupoNominaId.moneda_id AS grupoNominaIdmoneda_id,grupoNominaId.periodicidad_pago_id AS grupoNominaIdperiodicidad_pago_id,grupoNominaId.isr_aguinaldo_reglamento AS grupoNominaIdisr_aguinaldo_reglamento,grupoNominaId.es_automatica AS grupoNominaIdes_automatica,grupoNominaId.es_activo AS grupoNominaIdes_activo,grupoNominaId.es_predeterminado AS grupoNominaIdes_predeterminado,grupoNominaId.ajuste_mensual_isr AS grupoNominaIdajuste_mensual_isr,grupoNominaId.base_periodo_id AS grupoNominaIdbase_periodo_id,grupoNominaId.periodo_aguinaldo_id AS grupoNominaIdperiodo_aguinaldo_id,grupoNominaId.manera_calcular_subsidio AS grupoNominaIdmanera_calcular_subsidio,grupoNominaId.ajustar_base_gravable_faltantes AS grupoNominaIdajustar_base_gravable_faltantes,grupoNominaId.cuenta_banco_id AS grupoNominaIdcuenta_banco_id, " +
            "tipoCompensacionId.descripcion AS tipoCompensacionIddescripcion,tipoCompensacionId.nombre_corto AS tipoCompensacionIdnombre_corto,tipoCompensacionId.es_activo AS tipoCompensacionIdes_activo,tipoCompensacionId.fecha_alta AS tipoCompensacionIdfecha_alta " +
            "FROM nco_contrato_colaborador colaborador " +
            "INNER JOIN (SELECT persona_id,MAX(fecha_inicio) fecha FROM nco_contrato_colaborador GROUP BY persona_id) colaborador_fecha " +
            "ON colaborador.fecha_inicio = colaborador_fecha.fecha AND colaborador.persona_id = colaborador_fecha.persona_id " +
            "INNER JOIN ncl_puesto puestoId ON colaborador.puesto_id=puestoId.puesto_id " +
            "INNER JOIN ncl_centroc_cliente centrocClienteId ON colaborador.centroc_cliente_id=centrocClienteId.centroc_cliente_id " +
            "INNER JOIN ncl_area areaId ON colaborador.area_id=areaId.area_id " +
            "INNER JOIN nco_persona personaId ON colaborador.persona_id=personaId.persona_id " +
            "INNER JOIN cat_metodo_pago metodoId on colaborador.metodo_pago_id = metodoId.metodo_pago_id " +
            "INNER JOIN cs_tipo_regimen_contratacion tipoRegimenContratacionId on colaborador.de_tipo_regimen_contratacion_id = tipoRegimenContratacionId.tipo_regimen_contratacion_id " +
            "INNER JOIN ncl_jornada jornadaId on colaborador.de_jornada_id = jornadaId.jornada_id " +
            "INNER JOIN cat_estado estadoId on colaborador.de_c_estado = estadoId.c_estado " +
            "INNER JOIN ncl_politica politicaId on colaborador.politica_id = politicaId.politica_id " +
            "INNER JOIN ncl_grupo_nomina grupoNominaId on colaborador.grupo_nomina_id = grupoNominaId.grupo_nomina_id " +
            "INNER JOIN cat_tipo_compensacion tipoCompensacionId on colaborador.tipo_compensacion_id = tipoCompensacionId.tipo_compensacion_id " +
            "AND colaborador.centroc_cliente_id = :centrocClienteId " +
            "AND colaborador.es_activo = true  " +
            "AND colaborador.grupo_nomina_id = :grupoNominaId " +
            "AND :fechaPeriodo between colaborador.fecha_contrato and coalesce(colaborador.fecha_fin, :fechaPeriodo) " +
            "AND colaborador.estatus_baja_id IS NULL " +
            " UNION " +
            "SELECT colaborador.fecha_fin_ultimo_pago,colaborador.ppp_snm,colaborador.estatus_baja_id,colaborador.salario_diario_integrado,colaborador.ppp_monto_complementario,colaborador.ppp_sbm,colaborador.fecha_alta_imss,colaborador.jefe_inmediato_persona_id,colaborador.fecha_contrato,colaborador.salario_diario,colaborador.fecha_inicio,colaborador.fecha_fin,colaborador.de_fecha_antiguedad,colaborador.de_es_sindicalizado,colaborador.su_es_subcontratado,colaborador.su_porcentaje,colaborador.sueldo_bruto_mensual,colaborador.num_empleado,colaborador.sbc,colaborador.dias_vacaciones,colaborador.ba_fecha_para_calculo,colaborador.ba_ultimo_dia,colaborador.ba_notas,colaborador.es_activo,colaborador.de_tipo_jornada_id,colaborador.sueldo_neto_mensual,colaborador.su_subcontratista,colaborador.de_tipo_regimen_contratacion_id,colaborador.de_area_geografica_id,colaborador.de_c_estado,colaborador.metodo_pago_id,colaborador.ba_motivo_baja_id, colaborador.su_subcontratista_id,colaborador.puesto_id,colaborador.centroc_cliente_id,colaborador.de_jornada_id,colaborador.politica_id,colaborador.grupo_nomina_id,colaborador.ba_tipo_baja_id,colaborador.tipo_compensacion_id,colaborador.sede_id,colaborador.de_tipo_contrato_id,colaborador.area_id,colaborador.persona_id," +
            "puestoId.descripcion AS puestoIddescripcion,puestoId.nombre_corto AS puestoIdnombre_corto,puestoId.es_activo AS puestoIdes_activo,puestoId.fecha_alta AS puestoIdfecha_alta,puestoId.centroc_cliente_id AS puestoIdcentroc_cliente_id,puestoId.puesto_id_reporta AS puestoIdpuesto_id_reporta," +
            "centrocClienteId.curp AS centrocClienteIdcurp,centrocClienteId.rfc AS centrocClienteIdrfc,centrocClienteId.razon_social AS centrocClienteIdrazon_social,centrocClienteId.nombre AS centrocClienteIdnombre,centrocClienteId.fecha_constitucion AS centrocClienteIdfecha_constitucion,centrocClienteId.es_activo AS centrocClienteIdes_activo,centrocClienteId.centro_costos_centroc_cliente_id AS centrocClienteIdcentro_costos_centroc_cliente_id,centrocClienteId.cc_url_logo AS centrocClienteIdcc_url_logo,centrocClienteId.fecha_alta AS centrocClienteIdfecha_alta,centrocClienteId.em_c_regimenfiscal AS centrocClienteIdem_c_regimenfiscal,centrocClienteId.base_periodo_id AS centrocClienteIdbase_periodo_id,centrocClienteId.c_actividad_economica AS centrocClienteIdc_actividad_economica,centrocClienteId.certificado_sello_digital_id AS centrocClienteIdcertificado_sello_digital_id,centrocClienteId.multiempresa AS centrocClienteIdmultiempresa, " +
            "areaId.descripcion AS areaIddescripcion,areaId.nombre_corto AS areaIdnombre_corto,areaId.fecha_alta AS areaIdfecha_alta,areaId.es_activo AS areaIdes_activo,areaId.area_id_adscripcion AS areaIdarea_id_adscripcion,areaId.centroc_cliente_id AS areaIdcentroc_cliente_id," +
            "personaId.url_imagen AS personaIdurl_imagen,personaId.ci_puesto AS personaIdci_puesto, personaId.iba_num_hijos AS personaIdiba_num_hijos,personaId.ce_telefono AS personaIdce_telefono,personaId.ci_telefono AS personaIdci_telefono,personaId.ci_extension AS personaIdci_extension,personaId.curp AS personaIdcurp,personaId.rfc AS personaIdrfc,personaId.nombre AS personaIdnombre,personaId.apellido_pat AS personaIdapellido_pat,personaId.apellido_mat AS personaIdapellido_mat,personaId.email_corp AS personaIdemail_corp,personaId.genero AS personaIdgenero,personaId.nss AS personaIdnss,personaId.ce_nombre AS personaIdce_nombre,personaId.ce_e_mail AS personaIdce_e_mail,personaId.rl_url_firma AS personaIdrl_url_firma,personaId.ci_email_personal AS personaIdci_email_personal,personaId.ce_apellido_paterno AS personaIdce_apellido_paterno,personaId.ce_apellido_materno AS personaIdce_apellido_materno,personaId.iba_estado_civil AS personaIdiba_estado_civil,personaId.url_linkedin AS personaIdurl_linkedin,personaId.fecha_nace AS personaIdfecha_nace,personaId.fecha_alta AS personaIdfecha_alta,personaId.es_activo AS personaIdes_activo,personaId.tiene_curp AS personaIdtiene_curp,personaId.tiene_rfc AS personaIdtiene_rfc,personaId.tiene_nss AS personaIdtiene_nss,personaId.iba_tiene_hijos AS personaIdiba_tiene_hijos,personaId.invitar_empleado AS personaIdinvitar_empleado,personaId.iba_nacionalidad_id AS personaIdiba_nacionalidad_id,personaId.tipo_persona_id AS personaIdtipo_persona_id,personaId.tipo_representante_id AS personaIdtipo_representante_id,personaId.representante_legal_centroc_cliente_id AS personaIdrepresentante_legal_centroc_cliente_id,personaId.ce_parentesco_id AS personaIdce_parentesco_id,personaId.celular AS personaIdcelular,personaId.poder_notarial AS personaIdpoder_notarial, personaId.facultad_poder_id AS  personaIdfacultad_poder_id, " +
            "metodoId.descripcion AS metodoPagoIddescripcion,metodoId.nombre_corto AS metodoPagoIdnombre_corto,metodoId.fecha_alta AS metodoPagoIdfecha_alta,metodoId.es_activo AS metodoPagoIdes_activo, " +
            "tipoRegimenContratacionId.descripcion AS tipoRegimenContratacionIddescripcion,tipoRegimenContratacionId.fecha_inicio AS tipoRegimenContratacionIdfecha_inicio,tipoRegimenContratacionId.fecha_fin AS tipoRegimenContratacionIdfecha_fin,tipoRegimenContratacionId.es_activo AS tipoRegimenContratacionIdes_activo, " +
            "jornadaId.tipo_jornada_id AS jornadaIdtipo_jornada_id,jornadaId.nombre AS jornadaIdnombre,jornadaId.mismo_horario AS jornadaIdmismo_horario,jornadaId.horario_comida AS jornadaIdhorario_comida,jornadaId.incidir_asistencias AS jornadaIdincidir_asistencias,jornadaId.hora_entrada AS jornadaIdhora_entrada,jornadaId.hora_inicio_comida AS jornadaIdhora_inicio_comida,jornadaId.hora_fin_comida AS jornadaIdhora_fin_comida,jornadaId.hora_salida AS jornadaIdhora_salida,jornadaId.es_activo AS jornadaIdes_activo,jornadaId.centroc_cliente_id AS jornadaIdcentroc_cliente_id,jornadaId.an_minutos_tolerancia AS jornadaIdan_minutos_tolerancia,jornadaId.an_hay_tolerancia AS jornadaIdan_hay_tolerancia,jornadaId.registro_prima_dominical_auto AS jornadaIdregistro_prima_dominical_auto,jornadaId.registro_descanso_laboral_auto AS jornadaIdregistro_descanso_laboral_auto,jornadaId.an_permite_justificar_retardo AS jornadaIdan_permite_justificar_retardo,jornadaId.solo_un_registro_dia AS jornadaIdsolo_un_registro_dia,jornadaId.para_dias_parcialmente_laborados AS jornadaIdpara_dias_parcialmente_laborados,jornadaId.he_solicitud_horas_extra AS jornadaIdhe_solicitud_horas_extra,jornadaId.he_minutos AS jornadaIdhe_minutos,jornadaId.suma_horas_jornada_id AS jornadaIdsuma_horas_jornada_id, " +
            "estadoId.clave_estado AS estadoIdclave_estado, estadoId.es_activo AS estadoIdes_activo,estadoId.fecha_alta AS estadoIdfecha_alta,estadoId.c_estado AS estadoIdc_estado,estadoId.d_estado AS estadoIdd_estado, " +
            "politicaId.calculo_antiguedadx_id AS politicaIdcalculo_antiguedadx_id, politicaId.nombre AS politicaIdnombre,politicaId.es_activo AS politicaIdes_activo,politicaId.nombre_corto AS politicaIdnombre_corto, politicaId.dias_economicos AS politicaIddias_economicos, politicaId.prima_aniversario AS politicaIdprima_aniversario, politicaId.descuenta_faltas AS politicaIddescuenta_faltas, politicaId.descuenta_incapacidades AS politicaIddescuenta_incapacidades, politicaId.costo_vales_restaurante AS politicaIdcosto_vales_restaurante, politicaId.descuento_prop_7o_dia AS politicaIddescuento_prop_7o_dia,politicaId.es_activo AS politicaIdes_activo, politicaId.centroc_cliente_id AS politicaIdcentroc_cliente_id, politicaId.es_estandar AS politicaIdes_estandar, " +
            "grupoNominaId.pago_complementario AS grupoNominaIdpago_complementario, grupoNominaId.nombre AS grupoNominaIdnombre,grupoNominaId.nombre_corto AS grupoNominaIdnombre_corto,grupoNominaId.esquema_pago_id AS grupoNominaIdesquema_pago_id,grupoNominaId.centroc_cliente_id AS grupoNominaIdcentroc_cliente_id,grupoNominaId.moneda_id AS grupoNominaIdmoneda_id,grupoNominaId.periodicidad_pago_id AS grupoNominaIdperiodicidad_pago_id,grupoNominaId.isr_aguinaldo_reglamento AS grupoNominaIdisr_aguinaldo_reglamento,grupoNominaId.es_automatica AS grupoNominaIdes_automatica,grupoNominaId.es_activo AS grupoNominaIdes_activo,grupoNominaId.es_predeterminado AS grupoNominaIdes_predeterminado,grupoNominaId.ajuste_mensual_isr AS grupoNominaIdajuste_mensual_isr,grupoNominaId.base_periodo_id AS grupoNominaIdbase_periodo_id,grupoNominaId.periodo_aguinaldo_id AS grupoNominaIdperiodo_aguinaldo_id,grupoNominaId.manera_calcular_subsidio AS grupoNominaIdmanera_calcular_subsidio,grupoNominaId.ajustar_base_gravable_faltantes AS grupoNominaIdajustar_base_gravable_faltantes,grupoNominaId.cuenta_banco_id AS grupoNominaIdcuenta_banco_id, " +
            "tipoCompensacionId.descripcion AS tipoCompensacionIddescripcion,tipoCompensacionId.nombre_corto AS tipoCompensacionIdnombre_corto,tipoCompensacionId.es_activo AS tipoCompensacionIdes_activo,tipoCompensacionId.fecha_alta AS tipoCompensacionIdfecha_alta " +
            "FROM nco_contrato_colaborador colaborador " +
            "INNER JOIN (SELECT persona_id,MAX(fecha_inicio) fecha FROM nco_contrato_colaborador GROUP BY persona_id) colaborador_fecha " +
            "ON colaborador.fecha_inicio = colaborador_fecha.fecha AND colaborador.persona_id = colaborador_fecha.persona_id " +
            "INNER JOIN ncl_puesto puestoId ON colaborador.puesto_id=puestoId.puesto_id " +
            "INNER JOIN ncl_centroc_cliente centrocClienteId ON colaborador.centroc_cliente_id=centrocClienteId.centroc_cliente_id " +
            "INNER JOIN ncl_area areaId ON colaborador.area_id=areaId.area_id " +
            "INNER JOIN nco_persona personaId ON colaborador.persona_id=personaId.persona_id " +
            "INNER JOIN cat_metodo_pago metodoId on colaborador.metodo_pago_id = metodoId.metodo_pago_id " +
            "INNER JOIN cs_tipo_regimen_contratacion tipoRegimenContratacionId on colaborador.de_tipo_regimen_contratacion_id = tipoRegimenContratacionId.tipo_regimen_contratacion_id " +
            "INNER JOIN ncl_jornada jornadaId on colaborador.de_jornada_id = jornadaId.jornada_id  " +
            "INNER JOIN cat_estado estadoId on colaborador.de_c_estado = estadoId.c_estado " +
            "INNER JOIN ncl_politica politicaId on colaborador.politica_id = politicaId.politica_id " +
            "INNER JOIN ncl_grupo_nomina grupoNominaId on colaborador.grupo_nomina_id = grupoNominaId.grupo_nomina_id " +
            "INNER JOIN cat_tipo_compensacion tipoCompensacionId on colaborador.tipo_compensacion_id = tipoCompensacionId.tipo_compensacion_id " +
            "AND colaborador.centroc_cliente_id = :centrocClienteId " +
            "AND colaborador.es_activo = true  " +
            "AND colaborador.grupo_nomina_id = :grupoNominaId " +
            "AND :fechaFinPeriodo between colaborador.fecha_contrato and coalesce(colaborador.fecha_fin, :fechaFinPeriodo) " +
            "AND colaborador.estatus_baja_id IS NULL ",
            nativeQuery = true)
    @Join(value = "tipoCompensacionId", alias = "tipoCompensacionId")
    @Join(value = "grupoNominaId", alias = "grupoNominaId")
    @Join(value = "politicaId", alias = "politicaId")
    @Join(value = "estadoId", alias = "estadoId")
    @Join(value = "jornadaId", alias = "jornadaId")
    @Join(value = "tipoRegimenContratacionId", alias = "tipoRegimenContratacionId")
    @Join(value = "metodoPagoId", alias = "metodoPagoId")
    @Join(value = "areaId", alias = "areaId")
    @Join(value = "puestoId", alias = "puestoId")
    @Join(value = "centrocClienteId", alias = "centrocClienteId")
    @Join(value = "personaId", alias = "personaId")
    List<NcoContratoColaborador> findByCentrocClienteIdCentrocClienteIdAndGrupoNominaIdGrupoNominaIdAndFechaPeriodoUnion(Integer centrocClienteId, Integer grupoNominaId, Date fechaPeriodo, Date fechaFinPeriodo);

    boolean existsByNumEmpleadoAndCentrocClienteIdCentrocClienteIdAndEsActivo(String numEmpleado, Integer centrocClienteId,boolean esActivo);

    void updateByFechaContratoAndCentrocClienteIdAndPersonaId(Date fechaContrato, NclCentrocCliente centrocClienteId, NcoPersona personaId, BigDecimal sbc);

    void updateByFechaContratoAndCentrocClienteIdAndPersonaId(Date fechaContrato, NclCentrocCliente centrocClienteId, NcoPersona personaId, Integer estatusBajaId);

}
